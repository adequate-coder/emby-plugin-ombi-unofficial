define(["exports","./../modules/loading/loading.js","./../modules/emby-apiclient/connectionmanager.js","./../modules/emby-apiclient/apiclient.js","./../modules/emby-apiclient/events.js","./../modules/common/globalize.js","./../modules/common/playback/playbackmanager.js","./../modules/common/playback/playbackactions.js","./../modules/appheader/appheader.js","./../modules/backdrop/backdrop.js","./../modules/common/itemhelper.js","./../modules/common/dataformatter.js","./../modules/common/itemmanager/itemmanager.js","./../modules/layoutmanager.js","./../modules/common/usersettings/usersettings.js","./../modules/viewmanager/baseview.js","./../modules/emby-elements/emby-scroller/emby-scroller.js","./../modules/emby-elements/emby-tabs/emby-tabs.js","./../modules/emby-elements/emby-itemscontainer/emby-itemscontainer.js","./../modules/emby-elements/emby-button/emby-button.js","./../modules/emby-elements/sync/emby-downloadbutton.js","./../modules/emby-elements/emby-select/emby-select.js","./../modules/emby-elements/emby-dialogclosebutton/emby-dialogclosebutton.js","./../modules/listview/listview.js","./../modules/cardbuilder/cardbuilder.js","./../modules/itemcontextmenu.js","./../modules/indicators/indicators.js","./../modules/navdrawer/navdrawer.js","./../modules/common/textencoding.js","./../modules/dom.js","./../modules/approuter.js","./../modules/common/datetime.js","./../modules/mediainfo/mediainfo.js","./../modules/common/servicelocator.js","./../modules/focusmanager.js","./../modules/common/imagehelper.js","./../modules/skinmanager.js","./../modules/common/input/api.js","./linkeditems.js"],function(_exports,_loading,_connectionmanager,_apiclient,_events,_globalize,_playbackmanager,_playbackactions,_appheader,_backdrop,_itemhelper,_dataformatter,_itemmanager,_layoutmanager,_usersettings,_baseview,_embyScroller,_embyTabs,_embyItemscontainer,_embyButton,_embyDownloadbutton,_embySelect,_embyDialogclosebutton,_listview,_cardbuilder,_itemcontextmenu,_indicators,_navdrawer,_textencoding,_dom,_approuter,_datetime,_mediainfo,_servicelocator,_focusmanager,_imagehelper,_skinmanager,_api,_linkeditems){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,require(["flexStyles","css!item/item.css"]);var backdropContainer=document.querySelector(".backdropContainer"),backgroundContainer=document.querySelector(".backgroundContainer"),skinHeader=document.querySelector(".skinHeader"),decodingAttribute=_dom.default.supportsAsyncDecodedImages()?' decoding="async"':"";function showActionSheet(options){return Emby.importModule("./modules/actionsheet/actionsheet.js").then(function(ActionSheet){return ActionSheet.show(options)})}function renderTrackSelectionsWithoutUser(page,instance,item,forceReload){_connectionmanager.default.getApiClient(item.ServerId).getCurrentUser().then(function(user){renderTrackSelections(page,instance,item,user,forceReload)})}function isMediaStreamDisplayed(stream){return"Data"!==stream.Type}function renderMediaSources(page,renderAdminFields,item,mediaSources){for(var groupedVersions=mediaSources.filter(function(g){return"Grouping"===g.Type}),parentElem=(renderAdminFields&&groupedVersions.length?page.querySelector(".splitVersionContainer").classList.remove("hide"):page.querySelector(".splitVersionContainer").classList.add("hide"),page.querySelector(".mediaSources")),anyDisplayed=!1,i=(parentElem.innerHTML="",0),length=mediaSources.length;i<length;i++){var mediaSource=mediaSources[i];!function(version,renderAdminFields){for(var i=0,length=version.MediaStreams.length;i<length;i++)if("Data"!==version.MediaStreams[i].Type)return 1;return version.Container||version.Formats&&version.Formats.length||version.Path&&"Http"!==version.Protocol&&renderAdminFields||!!version.Size}(mediaSource,renderAdminFields)||(anyDisplayed=!0,function(parentElem,renderAdminFields,item,mediaSource,scrollX){var elem=document.createElement("div"),html=(elem.classList.add("mediaSource"),""),renderAdminFields=(html+=scrollX?'<div class="sectionTitle sectionTitle-cards secondaryText" style="display:block;padding: 0 0 .5em;margin-top:0;">':'<div style="display:block;">',mediaSource.Path&&("Http"!==mediaSource.Protocol||"Trailer"!==item.Type)&&renderAdminFields&&(html+="<div>"+mediaSource.Path+"</div>"),html+='<div class="mediaInfoItems">',mediaSource.Container&&(html+=mediaSource.Container.toUpperCase()),mediaSource.Size&&(html+='<span class="mediaInfoItem">'+_dataformatter.default.sizeToString(mediaSource.Size)+"</span>"),new Date(Date.parse(item.DateCreated))),renderAdminFields=(html+='<span class="mediaInfoItem">'+_globalize.default.translate("AddedOnValue",_datetime.default.toLocaleDateString(renderAdminFields)+" "+_datetime.default.getDisplayTime(renderAdminFields))+"</span>",elem.innerHTML=html=(html=html+"</div>"+"</div>")&&'<div class="padded-left padded-left-page padded-right">'+html+"</div>",elem.insertAdjacentHTML("beforeend",scrollX?'<div is="emby-scroller" class="emby-scroller padded-top-focusscale padded-bottom-focusscale padded-left padded-left-page padded-right" data-mousewheel="false" data-focusscroll="true" data-horizontal="true"><div is="emby-itemscontainer" class="detailMediaStreamsItemsContainer itemsContainer-defaultCardSize scrollSlider itemsContainer focusable focuscontainer-x" data-focusabletype="nearest"></div></div>':'<div is="emby-itemscontainer" class="vertical-list itemsContainer padded-left padded-left-page padded-right itemsContainer-defaultCardSize"></div>'),parentElem.appendChild(elem),mediaSource.MediaStreams.filter(isMediaStreamDisplayed).map(function(s){return _itemhelper.default.normalizeMediaStreamForDisplay(item,mediaSource,s)}));scrollX?_cardbuilder.default.buildCards(renderAdminFields,{shape:"backdrop",overlayText:!0,fields:["MediaStreamInfo"],itemsContainer:elem.querySelector(".itemsContainer"),action:"none",multiSelect:!1,ratingButton:!1,playedButton:!1,defaultIcon:!1,typeIndicator:!1,playedIndicator:!1,syncIndicator:!1,timerIndicator:!1,randomDefaultBackground:!1,imageFallback:!1,cardPadderClass:_layoutmanager.default.tv?"mediaStreamPadder-tv":"mediaStreamPadder",innerCardFooterClass:"mediaStreamInnerCardFooter",cardTextCssClass:"mediaStreamInnerCardFooter-cardText",enableUserData:!1,draggable:!1,enableFocusScaling:!1,horizontal:!0}):_listview.default.buildItems(renderAdminFields,{image:!1,fields:["MediaStreamInfo"],itemsContainer:elem.querySelector(".itemsContainer"),action:"none",multiSelect:!1,ratingButton:!1,playedButton:!1,defaultIcon:!1,typeIndicator:!1,playedIndicator:!1,syncIndicator:!1,timerIndicator:!1,randomDefaultBackground:!1,imageFallback:!1,innerCardFooterClass:"mediaStreamInnerCardFooter",enableUserDataButtons:!1,draggable:!1})}(parentElem,renderAdminFields,item,mediaSource,!0))}anyDisplayed&&_usersettings.default.showFullMediaInfoOnDetailScreen()?page.querySelector(".audioVideoMediaInfo").classList.remove("hide"):page.querySelector(".audioVideoMediaInfo").classList.add("hide")}function isRenderingTrackSelections(item){return!(!_itemhelper.default.supportsMediaSourceSelection(item)||-1===_playbackmanager.default.getSupportedCommands().indexOf("PlayMediaSource")||!_playbackmanager.default.canPlay(item))}function setTrackSelectionFieldDisabled(elem,disabled){disabled?elem.setAttribute("disabled","disabled"):elem.removeAttribute("disabled");elem=elem.closest(".selectContainer");(elem=elem&&elem.querySelector(".emby-select-wrapper-inline"))&&(disabled?elem.classList.add("emby-select-wrapper-inline-disabled"):elem.classList.remove("emby-select-wrapper-inline-disabled"))}function refreshChapters(view){var elem=view.querySelector(".chaptersItemsContainer");elem.waitForCustomElementUpgrade().then(function(){elem.refreshItems()})}function renderTrackSelections(view,instance,item,user,forceReload,mediaSources){var select=view.querySelector(".selectSource"),apiClient=_connectionmanager.default.getApiClient(item);isRenderingTrackSelections(item)?(mediaSources?Promise.resolve(mediaSources):_playbackmanager.default.getPlaybackMediaSources(item)).then(function(mediaSources){var renderAdminFields=user.Policy.IsAdministrator,renderAdminFields=(renderMediaSources(view,renderAdminFields,item,mediaSources),instance._currentPlaybackMediaSources=mediaSources,"TvChannel"!==item.Type&&instance.trackSelectionsContainer.classList.remove("hide"),select.value),selectedId=renderAdminFields||mediaSources[0].Id;select.innerHTML=mediaSources.map(function(v){var selected=v.Id===selectedId?" selected":"";return'<option value="'+v.Id+'"'+selected+">"+_textencoding.default.htmlEncode(v.Name)+"</option>"}).join(""),1<mediaSources.length?(setTrackSelectionFieldDisabled(select,!1),view.querySelector(".selectSourceContainer").classList.remove("hide")):(view.querySelector(".selectSourceContainer").classList.add("hide"),setTrackSelectionFieldDisabled(select,!0)),select.value===renderAdminFields&&!forceReload||(renderMediaInfo(0,view,item,mediaSources),renderVideoSelections(view,mediaSources),renderAudioSelections(view,mediaSources),renderSubtitleSelections(view,mediaSources),updateTrackSelectionsFocusState(instance,view),refreshChapters(view)),"TvChannel"===item.Type&&updateTrackSelectionsFocusState(instance,view)}):(renderMediaInfo(0,view,item,item.MediaSources||[]),renderMediaSources(view,user.Policy.IsAdministrator,item,item.MediaSources||[]),instance._currentPlaybackMediaSources=[],instance.trackSelectionsContainer.classList.add("hide"),select.innerHTML="",view.querySelector(".selectVideo").innerHTML="",view.querySelector(".selectAudio").innerHTML="",view.querySelector(".selectSubtitles").innerHTML="",setTrackSelectionFieldDisabled(select,!0),updateTrackSelectionsFocusState(instance,view),refreshChapters(view))}function renderVideoSelections(page,mediaSources){var mediaSourceId=page.querySelector(".selectSource").value,mediaSources=mediaSources.filter(function(m){return m.Id===mediaSourceId})[0].MediaStreams.filter(function(m){return"Video"===m.Type&&(-1!==m.Index||null!=m.DisplayTitle||null!=m.Codec)}),select=page.querySelector(".selectVideo"),selectedId=mediaSources.length?mediaSources[0].Index:-1;select.innerHTML=mediaSources.map(function(v){var selected=v.Index===selectedId?" selected":"";return'<option value="'+v.Index+'" '+selected+">"+_textencoding.default.htmlEncode(v.DisplayTitle||(null==(selected=v.Codec)?void 0:selected.toUpperCase())||"")+"</option>"}).join(""),setTrackSelectionFieldDisabled(select,!0),mediaSources.length?page.querySelector(".selectVideoContainer").classList.remove("hide"):page.querySelector(".selectVideoContainer").classList.add("hide")}function renderAudioSelections(page,mediaSources){var mediaSourceId=page.querySelector(".selectSource").value,mediaSources=mediaSources.filter(function(m){return m.Id===mediaSourceId})[0],tracks=mediaSources.MediaStreams.filter(function(m){return"Audio"===m.Type&&(-1!==m.Index||null!=m.DisplayTitle||null!=m.Codec)}),select=page.querySelector(".selectAudio"),selectedId=mediaSources.DefaultAudioStreamIndex;select.innerHTML=tracks.map(function(v){var selected=v.Index===selectedId?" selected":"",embeddedTitle=v.Title&&!(v.DisplayTitle||"").includes(v.Title)?v.Title:null;return"<option"+(embeddedTitle?' title="'+embeddedTitle+'"':"")+' value="'+v.Index+'" '+selected+">"+_textencoding.default.htmlEncode(v.DisplayTitle||(null==(embeddedTitle=v.Codec)?void 0:embeddedTitle.toUpperCase())||"")+"</option>"}).join(""),1<tracks.length?setTrackSelectionFieldDisabled(select,!1):setTrackSelectionFieldDisabled(select,!0),tracks.length?page.querySelector(".selectAudioContainer").classList.remove("hide"):page.querySelector(".selectAudioContainer").classList.add("hide")}function renderSubtitleSelections(page,mediaSources){var selected,mediaSourceId=page.querySelector(".selectSource").value,mediaSources=mediaSources.filter(function(m){return m.Id===mediaSourceId})[0],tracks=mediaSources.MediaStreams.filter(function(m){return"Subtitle"===m.Type}),select=page.querySelector(".selectSubtitles"),selectedId=null==mediaSources.DefaultSubtitleStreamIndex?-1:mediaSources.DefaultSubtitleStreamIndex;tracks.length?(selected=-1===selectedId?" selected":"",select.innerHTML='<option value="-1">'+_globalize.default.translate("Off")+"</option>"+tracks.map(function(v){selected=v.Index===selectedId?" selected":"";var embeddedTitle=v.Title&&!(v.DisplayTitle||"").includes(v.Title)?v.Title:null;return"<option"+(embeddedTitle?' title="'+embeddedTitle+'"':"")+' value="'+v.Index+'" '+selected+">"+_textencoding.default.htmlEncode(v.DisplayTitle)+"</option>"}).join(""),page.querySelector(".selectSubtitlesContainer").classList.remove("hide")):(select.innerHTML="",page.querySelector(".selectSubtitlesContainer").classList.add("hide"))}function setButtonText(page,query,html){for(var elems=page.querySelectorAll(query),i=0,length=elems.length;i<length;i++){elems[i].innerHTML=html;var btn=elems[i].closest("button");btn&&(btn.title=html,btn.setAttribute("aria-label",html))}}function setResumeProgress(resumeInfoElement,item){var ticksLeft,resumeInfoElement=resumeInfoElement.querySelector(".resumeProgress");item.UserData&&0<item.UserData.PlaybackPositionTicks&&item.RunTimeTicks?(ticksLeft=item.RunTimeTicks-item.UserData.PlaybackPositionTicks,ticksLeft='<div class="resumeTimeRemaining secondaryText">'+_globalize.default.translate("TimeRemainingValue",_datetime.default.getHumanReadableRuntime(ticksLeft))+"</div>",resumeInfoElement.innerHTML=_indicators.default.getProgressBarHtml(item,{containerClass:"resumeInfoProgressBar",animated:!0})+ticksLeft,resumeInfoElement.classList.remove("hide")):resumeInfoElement.classList.add("hide")}function reloadPlayButtons(instance,page,item,isUserDataChangeEvent){var now,activeElement,isPlayFocused,btnPlay,btnResume,btnPlayTrailer,btnShuffle,playButtons=page.querySelectorAll(".btnPlay");"Program"===item.Type?((now=new Date)>=new Date(Date.parse(item.StartDate))&&now<new Date(Date.parse(item.EndDate))?hideAll(page,playButtons,!0):hideAll(page,playButtons),hideAll(page,"btnResume"),hideAll(page,"detailResumeInfo"),hideAll(page,"btnShuffle"),hideAll(page,"btnQueue"),setButtonText(page,".playButtonText",_globalize.default.translate("Play"))):_playbackmanager.default.canPlay(item)?(hideAll(page,"btnPlay",!0),now=item.IsFolder||-1!==["MusicAlbum","MusicGenre","MusicArtist"].indexOf(item.Type),"MusicAlbum"===item.Type&&item.SupportsResume&&(now=!1),hideAll(page,"btnShuffle",now="Season"!==item.Type&&"Series"!==item.Type?now:!1),isPlayFocused=(activeElement=document.activeElement)&&activeElement.classList&&(activeElement.classList.contains("btnResume")||activeElement.classList.contains("btnMainPlay")),btnPlay=page.querySelector(".btnPlay"),btnResume=page.querySelector(".btnResume"),(btnPlayTrailer=page.querySelector(".btnPlayTrailer-main")).querySelector("i").innerHTML=_itemmanager.default.getDefaultIcon({Type:"Trailer",MediaType:"Video"}),btnShuffle=page.querySelector(".btnShuffle"),"Series"===item.Type||"MusicAlbum"===item.Type&&item.SupportsResume?(btnResume.classList.add("detailButton-primary"),btnPlay.classList.remove("detailButton-primary","detailButton-highres3"),function(instance,page){getNextUpItems.call(instance,{Limit:1,EnableTotalRecordCount:!1}).then(function(result){var resumeNameElement,resumeName,result=result.Items[0],resumeInfo=page.querySelector(".detailResumeInfo");result?(resumeNameElement=resumeInfo.querySelector(".resumeName"),resumeName=_itemmanager.default.getDisplayName(result),_layoutmanager.default.tv||(resumeName='<a is="emby-linkbutton" class="button-link button-link-color-inherit" href="'+_approuter.default.getRouteUrl(result,{})+'">'+resumeName+"</a>"),resumeNameElement.innerHTML=resumeName,resumeNameElement.classList.remove("hide"),setResumeProgress(resumeInfo,result),result.UserData&&0<result.UserData.PlaybackPositionTicks?setButtonText(page,".resumeButtonText",_globalize.default.translate("Resume")):setButtonText(page,".resumeButtonText",_globalize.default.translate("Play")),resumeInfo.classList.remove("hide")):(setButtonText(page,".resumeButtonText",_globalize.default.translate("Play")),resumeInfo.classList.add("hide"))})}(instance,page),setButtonText(page,".playButtonText",_globalize.default.translate("FromBeginning")),btnPlay.classList.remove("detailButton-stacked"),btnShuffle.classList.remove("detailButton-stacked"),isTrailerButtonVisible(item)?(btnPlayTrailer.classList.add("detailButton-stacked"),btnResume.classList.add("detailButton-stacked")):(btnPlayTrailer.classList.remove("detailButton-stacked"),btnResume.classList.remove("detailButton-stacked")),hideAll(page,"detailResumeInfo",!0),hideAll(page,"btnResume",!0),hideAll(page,"btnPlay",now)):((instance=item.UserData&&0<item.UserData.PlaybackPositionTicks)?(btnResume.classList.add("detailButton-primary","detailButton-stacked"),btnPlay.classList.remove("detailButton-primary","detailButton-stacked"),_layoutmanager.default.tv?btnPlay.classList.remove("detailButton-highres3"):btnPlay.classList.add("detailButton-highres3"),btnPlayTrailer.classList.add("detailButton-stacked"),btnShuffle.classList.remove("detailButton-stacked"),setButtonText(page,".playButtonText",_globalize.default.translate("FromBeginning")),hideAll(page,"detailResumeInfo",!0),hideAll(page,"resumeName"),setResumeProgress(page.querySelector(".detailResumeInfo"),item)):(btnPlay.classList.add("detailButton-primary"),btnPlay.classList.remove("detailButton-highres3"),now?(btnPlayTrailer.classList.remove("detailButton-stacked"),btnResume.classList.remove("detailButton-stacked"),btnShuffle.classList.add("detailButton-stacked"),btnPlay.classList.add("detailButton-stacked")):(isTrailerButtonVisible(item)?(btnPlay.classList.add("detailButton-stacked"),btnResume.classList.remove("detailButton-stacked"),btnPlayTrailer.classList.add("detailButton-stacked")):(btnPlay.classList.remove("detailButton-stacked"),btnResume.classList.remove("detailButton-stacked"),btnPlayTrailer.classList.remove("detailButton-stacked")),btnShuffle.classList.remove("detailButton-stacked")),setButtonText(page,".playButtonText",_globalize.default.translate("Play"))),hideAll(page,"detailResumeInfo",instance),hideAll(page,"btnResume",instance)),isUserDataChangeEvent||hideAll(page,"btnQueue",_playbackmanager.default.canQueue(item)),isPlayFocused&&focusMainSection.call(activeElement.parentNode)):(hideAll(page,playButtons),hideAll(page,"btnQueue"),hideAll(page,"btnResume"),hideAll(page,"detailResumeInfo"),hideAll(page,"btnShuffle"))}function focusMainSection(){for(var btns=this.querySelectorAll(".detailButton"),i=0,length=btns.length;i<length;i++){var btn=btns[i];if(_focusmanager.default.isCurrentlyFocusable(btn))try{return void _focusmanager.default.focus(btn)}catch(err){}}_focusmanager.default.autoFocus(this,{skipIfNotEnabled:!0})}function setTitle(item,apiClient,enableLogo){(enableLogo="TvChannel"===item.Type?!1:enableLogo)?_appheader.default.setLogoTitle({items:[item],titleText:"",preferredLogoImageTypes:_skinmanager.default.getPreferredLogoImageTypes()}):_appheader.default.setTitle("")}function getLogoPlacement(item){return"TvChannel"===item.Type?null:("MusicAlbum"!==item.Type&&"Audio"!==item.Type&&"MusicVideo"!==item.Type||item.ImageTags&&item.ImageTags.Logo)&&_usersettings.default.getEnableLogoAsTitle(_globalize.default.getCurrentLocale())?"title":"float"}function getArtistLinksHtml(artists,serverId){for(var html=[],i=0,length=artists.length;i<length;i++){var artist=artists[i],href=_approuter.default.getRouteUrl(artist,{itemType:"MusicArtist",serverId:serverId});html.push('<a style="font-weight:inherit;" class="button-link" is="emby-linkbutton" href="'+href+'">'+_textencoding.default.htmlEncode(artist.Name)+"</a>")}return html=html.join(" / ")}function inferContext(item){switch(item.Type){case"Series":case"Season":case"Episode":return"tvshows";case"Movie":return"movies";case"Game":case"GameSystem":return"games";case"MusicArtist":case"MusicAlbum":case"Audio":case"AudioBook":case"MusicVideo":case"MusicGenre":return"music";case"Program":case"TvChannel":case"Timer":case"SeriesTimer":return"livetv";default:return null}}function isTrailerButtonVisible(item){if(_playbackmanager.default.getSupportedCommands().includes("PlayTrailers")){if(item.LocalTrailerCount)return 1;if(item.RemoteTrailers&&item.RemoteTrailers.length)return 1}}function setTrailerButtonVisibility(page,item){isTrailerButtonVisible(item)?hideAll(page,"btnPlayTrailer",!0):hideAll(page,"btnPlayTrailer")}function enableTrackList(item){return!!_layoutmanager.default.tv&&("Playlist"===item.Type||"MusicAlbum"===item.Type&&!item.SupportsResume)}function enableItemBackdropAsTopImage(item){return"Playlist"!==item.Type&&"MusicAlbum"!==item.Type&&"TvChannel"!==item.Type&&"Audio"!==item.Type}function hideAll(page,className,show){for(var elems="string"==typeof className?page.querySelectorAll("."+className):className,i=0,length=elems.length;i<length;i++)show?elems[i].classList.remove("hide"):elems[i].classList.add("hide")}function getCommandOptions(instance,item,user,button){var selectSource=instance.view.querySelector(".selectSource"),instance="true"===instance.params.asDialog,item={items:[item],open:!1,play:!1,playFromBeginning:!0,playAllFromHere:!1,positionTo:button,cancelTimer:!1,record:!1,deleteItem:!0,shuffle:!0,instantMix:!0,user:user,share:!0,mediaSourceId:(null==selectSource?void 0:selectSource.value)||null,positionY:"center",positionX:"after",transformOrigin:"left top",navigateOnDelete:"back",showSeries:!!_layoutmanager.default.tv,showSeason:!0,createRecording:!instance,edit:!instance,editImages:!instance,favorites:!instance};return _servicelocator.appHost.supports("sync")&&!_layoutmanager.default.tv&&(item.syncLocal=!1),item}function renderMediaInfo(instance,view,item,mediaSources){var hasFocusElements,genreLimit,mediaSourceId=view.querySelector(".selectSource").value,itemType=item.Type,mediaSources=mediaSources.filter(function(m){return m.Id===mediaSourceId})[0],mediaInfoElem=view.querySelector(".mediaInfoPrimary");if(_layoutmanager.default.tv?mediaInfoElem.classList.add("detail-mediaInfoPrimary-tv"):mediaInfoElem.classList.add("detail-mediaInfoPrimary-autocondense"),"Season"===itemType||"SeriesTimer"===itemType)mediaInfoElem.classList.add("hide"),mediaInfoElem.classList.remove("focuscontainer-x");else{switch(itemType){case"Playlist":case"BoxSet":case"MusicArtist":genreLimit=_usersettings.default.genreLimitForListsOnDetails();break;default:genreLimit=_usersettings.default.genreLimitOnDetails()}_mediainfo.default.fillPrimaryMediaInfo(mediaInfoElem,item,{interactive:!0,episodeTitle:!1,subtitles:!1,dateAdded:!1,genres:!0,genreLimit:genreLimit,context:inferContext(item),endsAt:_usersettings.default.showEndsAtOnDetails(),endsAtClass:"detailEndsAt",bitrate:"Audio"===item.MediaType,runtime:"Timer"!==itemType,mediaSource:mediaSources,mediaInfoIcons:!1}),hasFocusElements=null!=mediaInfoElem.querySelector("a,button"),setScopedFocus(null,mediaInfoElem,hasFocusElements),hasFocusElements?mediaInfoElem.classList.add("focuscontainer-x"):mediaInfoElem.classList.remove("focuscontainer-x")}enableItemBackdropAsTopImage(item)?mediaInfoElem.classList.remove("mediaInfo-centered","secondaryText"):mediaInfoElem.classList.add("mediaInfo-centered","secondaryText"),mediaInfoElem=view.querySelector(".mediaInfoSecondary"),_mediainfo.default.fillSecondaryMediaInfo(mediaInfoElem,item,{interactive:!0,mediaSource:mediaSources}),hasFocusElements=null!=mediaInfoElem.querySelector("a,button"),setScopedFocus(null,mediaInfoElem,hasFocusElements),hasFocusElements?mediaInfoElem.classList.add("focuscontainer-x"):mediaInfoElem.classList.remove("focuscontainer-x"),mediaInfoElem.innerHTML.trim()?mediaInfoElem.classList.remove("hide"):mediaInfoElem.classList.add("hide")}function renderDetails(instance,view,item,apiClient,user){var promises=[],overviewElem=view.querySelector(".overview-container"),overviewTextElem=overviewElem.querySelector(".overview-text"),itemForDetails=(enableTrackList(item)?overviewTextElem.classList.add("overview-text-tracklist"):overviewTextElem.classList.remove("overview-text-tracklist"),"Timer"===item.Type&&item.ProgramInfo||item),overview=itemForDetails.Overview;overview?(function(elem,overview){var scrollHeight,textButton,textElement=elem.querySelector(".overview-text"),btnReadMore=elem.querySelector(".btnReadMore");btnReadMore.innerHTML=_globalize.default.translate("More"),overview?(textElement.innerHTML=overview,elem.classList.remove("hide"),overview=textElement.offsetHeight,scrollHeight=textElement.scrollHeight,textButton=textElement.closest("button"),overview&&scrollHeight&&overview<scrollHeight?(_layoutmanager.default.tv?(textButton.removeAttribute("disabled"),btnReadMore.classList.add("hide")):(textButton.setAttribute("disabled","disabled"),btnReadMore.classList.remove("hide")),setScopedFocus(null,elem,!0)):(textButton.setAttribute("disabled","disabled"),btnReadMore.classList.add("hide"),setScopedFocus(null,elem,!1))):(elem.classList.add("hide"),textElement.innerHTML="")}(overviewElem,overview?_dom.default.stripScripts(overview):""),"MusicAlbum"===itemForDetails.Type||"Playlist"===itemForDetails.Type?overviewTextElem.classList.add("overview-twoline"):overviewTextElem.classList.remove("overview-twoline")):overviewElem.classList.add("hide"),function(view,item){var directors=(item.People||[]).filter(function(p){return"Director"===p.Type}),html=(directors=_layoutmanager.default.tv?[]:directors).map(function(p){return _layoutmanager.default.tv?"<span>"+_textencoding.default.htmlEncode(p.Name)+"</span>":'<a class="button-link button-link-color-inherit" is="emby-linkbutton" href="'+_approuter.default.getRouteUrl({Name:p.Name,Type:"Person",ServerId:item.ServerId,Id:p.Id},{})+'">'+_textencoding.default.htmlEncode(p.Name)+"</a>"}).join(", "),elem=view.querySelector(".directors");elem.innerHTML=1<directors.length?_globalize.default.translate("DirectorsValue",html):_globalize.default.translate("DirectorValue",html),setScopedFocus(view,elem,directors.length&&!_layoutmanager.default.tv),directors.length?elem.classList.remove("hide"):elem.classList.add("hide")}(view,itemForDetails),reloadPlayButtons(instance,view,item),function(page,item){for(var btnPlaystates=page.querySelectorAll(".btnPlaystate"),i=0,length=btnPlaystates.length;i<length;i++){var btnPlaystate=btnPlaystates[i];_itemmanager.default.canMarkPlayed(item)?(btnPlaystate.classList.remove("hide"),btnPlaystate.setItem(item)):(btnPlaystate.classList.add("hide"),btnPlaystate.setItem(null))}var btnUserRatings=page.querySelectorAll(".btnUserRating");for(i=0,length=btnUserRatings.length;i<length;i++){var btnUserRating=btnUserRatings[i];_itemmanager.default.canRate(item)?(btnUserRating.classList.remove("hide"),btnUserRating.setItem(item)):(btnUserRating.classList.add("hide"),btnUserRating.setItem(null))}}(view,item),setTrailerButtonVisibility(view,item),"TvChannel"===item.Type?hideAll(view,"btnManualRecording",!0):hideAll(view,"btnManualRecording"),item.CanDelete&&!item.IsFolder&&"MusicArtist"!==item.Type?hideAll(view,"btnDeleteItem",!0):hideAll(view,"btnDeleteItem"),promises.push(function(instance,page,item,user){if(instance.currentRecordingFields)return instance.currentRecordingFields.refresh(item),Promise.resolve();return"Program"===item.Type&&user.Policy.EnableLiveTvManagement?require(["recordingFields"]).then(function(responses){var responses=responses[0],recordingFieldsElement=page.querySelector(".mainDetailButtons");instance.currentRecordingFields=new responses({parent:recordingFieldsElement,program:item}),_events.default.on(instance.currentRecordingFields,"recordingchanged",onRecordingChanged.bind(instance)),_events.default.on(instance.currentRecordingFields,"seriesrecordingchanged",onRecordingChanged.bind(instance))}):Promise.resolve()}(instance,view,item,user));_itemmanager.default.getCommands(getCommandOptions(instance,item,user)).length?hideAll(view,"btnMoreCommands",!0):hideAll(view,"btnMoreCommands"),0<getSortMenuOptions(item).length?hideAll(view,"btnSortItems",!0):hideAll(view,"btnSortItems"),"BoxSet"===item.Type?hideAll(view,"btnGroupBy",!0):hideAll(view,"btnGroupBy");var overview=view.querySelector(".tagline"),aboutSection=(itemForDetails.Taglines&&itemForDetails.Taglines.length?(overview.classList.remove("hide"),overview.innerHTML=_dom.default.stripScripts(itemForDetails.Taglines[0])):overview.classList.add("hide"),_layoutmanager.default.tv?overview.classList.remove("tagline-margin"):overview.classList.add("tagline-margin"),"Person"===itemForDetails.Type&&(overviewTextElem=view.querySelector(".birthDate"),itemForDetails.PremiereDate?(overviewElem=_datetime.default.toLocaleDateString(new Date(Date.parse(itemForDetails.PremiereDate)),{year:"numeric",month:"long",day:"numeric"}),overviewElem=itemForDetails.ProductionLocations&&itemForDetails.ProductionLocations.length?_globalize.default.translate("BornValueWithPlace",overviewElem,itemForDetails.ProductionLocations[0]):_globalize.default.translate("BornValue",overviewElem),overviewTextElem.innerHTML=overviewElem,overviewTextElem.classList.remove("hide")):overviewTextElem.classList.add("hide"),instance=view.querySelector(".deathDate"),itemForDetails.EndDate?(user=_datetime.default.toLocaleDateString(new Date(Date.parse(itemForDetails.EndDate)),{year:"numeric",month:"long",day:"numeric"}),user=_globalize.default.translate("DiedValue",user),instance.innerHTML=user,instance.classList.remove("hide")):instance.classList.add("hide")),!function(page,item,context){var type,itemGenres=page.querySelector(".itemGenres"),genreElements=[],genres=item.GenreItems||[];switch(context){case"games":type="GameGenre";break;case"music":type="MusicGenre";break;default:type="Genre"}for(var i=0,length=genres.length;i<length;i++){var href=_approuter.default.getRouteUrl({Name:genres[i].Name,Type:type,ServerId:item.ServerId,Id:genres[i].Id},{context:context}),text=_textencoding.default.htmlEncode(genres[i].Name);i<length-1&&(text+=","),genreElements.push('<a is="emby-linkbutton" class="button-link button-link-color-inherit button-link-fontweight-inherit nobackdropfilter" href="'+href+'">'+text+"</a>")}itemGenres.innerHTML=genreElements.join(""),genreElements.length?page.querySelector(".genresSection").classList.remove("hide"):page.querySelector(".genresSection").classList.add("hide")}(view,item,inferContext(item)),!function(page,item){for(var itemTags=page.querySelector(".itemTags"),tagElements=[],tags=item.TagItems||[],i=0,length=tags.length;i<length;i++){var href=_approuter.default.getRouteUrl({Name:tags[i].Name,Type:"Tag",ServerId:item.ServerId,Id:tags[i].Id},{itemTypes:"Person"===item.Type||"MusicArtist"===item.Type?item.Type:null}),text=_textencoding.default.htmlEncode(tags[i].Name);i<length-1&&(text+=","),tagElements.push('<a is="emby-linkbutton" class="button-link button-link-color-inherit button-link-fontweight-inherit nobackdropfilter" href="'+href+'">'+text+"</a>")}itemTags.innerHTML=tagElements.join(""),tagElements.length?page.querySelector(".tagsSection").classList.remove("hide"):page.querySelector(".tagsSection").classList.add("hide")}(view,item),!function(page,item){for(var itemStudios=page.querySelector(".itemStudios"),studioElements=[],studios=item.Studios||[],i=0,length=studios.length;i<length;i++){var href=_approuter.default.getRouteUrl({Name:studios[i].Name,Type:"Studio",ServerId:item.ServerId,Id:studios[i].Id},{itemTypes:"Person"===item.Type||"MusicArtist"===item.Type?item.Type:null}),text=_textencoding.default.htmlEncode(studios[i].Name);i<length-1&&(text+=","),studioElements.push('<a is="emby-linkbutton" class="button-link button-link-color-inherit button-link-fontweight-inherit nobackdropfilter" href="'+href+'">'+text+"</a>")}itemStudios.innerHTML=studioElements.join(""),studioElements.length?page.querySelector(".studiosSection").classList.remove("hide"):page.querySelector(".studiosSection").classList.add("hide")}(view,item),!function(page,item){var page=page.querySelector(".linksSection"),links=[];if(item.ExternalUrls&&_servicelocator.appHost.supports("externallinks")&&_servicelocator.appHost.supports("targetblank")&&!_layoutmanager.default.tv)for(var i=0,length=item.ExternalUrls.length;i<length;i++){var url=item.ExternalUrls[i],text=_textencoding.default.htmlEncode(url.Name);i<length-1&&(text+=","),links.push('<a is="emby-linkbutton" class="button-link button-link-color-inherit button-link-fontweight-inherit nobackdropfilter" href="'+url.Url+'" target="_blank">'+text+"</a>")}page.querySelector(".itemLinks").innerHTML=links.join(""),links.length?page.classList.remove("hide"):page.classList.add("hide")}(view,item),view.querySelector(".aboutSection"));switch(item.Type){case"TvChannel":case"Playlist":case"Tag":case"Studio":case"Genre":case"GameGenre":case"MusicGenre":case"Season":case"Timer":case"SeriesTimer":case"Program":aboutSection.classList.add("hide");break;default:aboutSection.querySelector("a,button:not(.btnSplitVersions)")||isRenderingTrackSelections(item)?aboutSection.classList.remove("hide"):aboutSection.classList.add("hide")}return Promise.all(promises)}function onRecordingChanged(){reloadItem(this,!0)}function onTrackSelectionsSubmit(e){return e.preventDefault(),!1}function bindAll(view,selector,eventName,fn){for(var elems=view.querySelectorAll(selector),i=0,length=elems.length;i<length;i++)elems[i].addEventListener(eventName,fn)}function executeCommandWithCommandProcessor(command,item,options){require(["commandProcessor"]).then(function(responses){return responses[0].executeCommand(command,[item],options)})}function onDataFetched(responses){var itemInfo=responses[0],item=itemInfo.item,itemInfo=itemInfo.mediaSources,user=responses[1],responses=_connectionmanager.default.getApiClient(item.ServerId),view=this.view,willHaveBackdrop=_backdrop.default.hasBackdrop(),backdropOptions={enableAnimation:!0,enablePrimaryImageBeforeInherited:enableTvDetailImageLayout(this,item)&&!enableDetailPoster(this,item)&&"Season"!==item.Type&&"Episode"!==item.Type,allowPrimaryImage:enableTvDetailImageLayout(this,item)&&!enableDetailPoster(this,item)},itemMainScrollSlider=("Person"===item.Type&&_backdrop.default.hasBackdrop()||"true"!==this.params.asDialog&&(willHaveBackdrop=0<_backdrop.default.getBackdropsFromOptions([item],backdropOptions).length,setNewBackdrop=!0),this.updateDrawerState(),view.querySelector(".itemMainScrollSlider")),detailMainContainerParent=view.querySelector(".detailMainContainerParent"),asDialog="true"===this.params.asDialog,itemMainScrollSlider=(willHaveBackdrop&&!asDialog?(skinHeader.classList.add("darkContentContainer"),enableTvDetailImageLayout(this,item)?(_layoutmanager.default.tv?(itemMainScrollSlider.classList.add("itemMainScrollSlider-fade"),_playbackmanager.default.isPlayingLocally(["Video"])?backgroundContainer.classList.remove("itemBackgroundContainer-transparent"):backgroundContainer.classList.add("itemBackgroundContainer-transparent")):(itemMainScrollSlider.classList.remove("itemMainScrollSlider-fade"),backgroundContainer.classList.remove("itemBackgroundContainer-transparent")),detailMainContainerParent.classList.add("detailMainContainerParent-fade"),view.classList.add("darkContentContainer-tv","darkContentContainer-item")):(itemMainScrollSlider.classList.remove("itemMainScrollSlider-fade"),detailMainContainerParent.classList.remove("detailMainContainerParent-fade"),_layoutmanager.default.tv?view.classList.add("darkContentContainer-tv","darkContentContainer-item"):view.classList.add("darkContentContainer-item"),backgroundContainer.classList.remove("itemBackgroundContainer-transparent")),enableItemBackdropAsTopImage(item)?(backdropContainer.classList.add("backdropContainer-preventbackdrop"),backgroundContainer.classList.add("itemBackgroundContainer","itemBackgroundContainer-preventbackdrop")):(backdropContainer.classList.remove("backdropContainer-preventbackdrop"),backgroundContainer.classList.add("itemBackgroundContainer"),backgroundContainer.classList.remove("itemBackgroundContainer-preventbackdrop"))):(view.classList.remove("darkContentContainer-item","darkContentContainer-tv"),itemMainScrollSlider.classList.remove("itemMainScrollSlider-fade"),detailMainContainerParent.classList.remove("detailMainContainerParent-fade"),asDialog||(skinHeader.classList.remove("darkContentContainer"),backgroundContainer.classList.remove("itemBackgroundContainer","itemBackgroundContainer-transparent","itemBackgroundContainer-preventbackdrop"),backdropContainer.classList.remove("backdropContainer-preventbackdrop"))),setNewBackdrop&&_backdrop.default.setBackdrops([item],backdropOptions),this.currentItem=item,[]),detailMainContainerParent=(this.sectionsInitialized||(this.sectionsInitialized=!0,function(instance,view,item){var section;"Episode"===item.Type&&(view=view.querySelector(".moreFromSeasonItemsContainer"),(section=view.closest(".verticalSection")).querySelector("h2").innerHTML=_globalize.default.translate("MoreFromValue",item.SeasonName),view.fetchData=function(query){var apiClient,item=this.currentItem;return item.SeasonId&&item.SeriesId?(apiClient=_connectionmanager.default.getApiClient(item),query=Object.assign({SeasonId:item.SeasonId,UserId:apiClient.getCurrentUserId(),Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio"},query),apiClient.getEpisodes(item.SeriesId,query).then(function(result){return!query.StartIndex&&result.Items.length<2?Promise.resolve({TotalRecordCount:0,Items:[]}):result})):Promise.resolve({TotalRecordCount:0,Items:[]})}.bind(instance),view.parentContainer=section,view.getListOptions=getMoreFromSeasonListOptions,view.afterRefresh=function(totalResult){if(totalResult.Items.length){var item=this.currentItem;if(item){var view=this.view;if(view){var itemsContainer=view.querySelector(".moreFromSeasonItemsContainer");if(itemsContainer){var query,index=itemsContainer.indexOfItemId(item.Id);if(-1===index)return view=_connectionmanager.default.getApiClient(item),query={SeasonId:item.SeasonId,UserId:view.getCurrentUserId(),Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio",Limit:0,StartItemId:item.Id},view.getEpisodes(item.SeriesId,query).then(function(result){index=Math.max(totalResult.TotalRecordCount-result.TotalRecordCount,0),itemsContainer.scrollToIndex(Math.min(index+1,totalResult.TotalRecordCount-1),{behavior:"instant",offset:"-padding-inline-start"},!1)});itemsContainer.scrollToIndex(Math.min(index+1,totalResult.TotalRecordCount-1),{behavior:"instant",offset:"-padding-inline-start"},!1)}}}}}.bind(instance),view.classList.add("generalItemsContainer"))}(this,view,item),function(instance,view,item){var section;"MusicArtist"!==item.Type&&"MusicAlbum"!==item.Type||(view=view.querySelector(".moreFromArtistItemsContainer"),section=view.closest(".verticalSection"),"MusicArtist"===item.Type?section.querySelector(".sectionTitle").innerHTML=_globalize.default.translate("HeaderAppearsOn"):section.querySelector(".sectionTitle").innerHTML=_globalize.default.translate("MoreFromValue",_textencoding.default.htmlEncode(item.AlbumArtists[0].Name)),view.fetchData=function(query){var item=this.currentItem;if("MusicAlbum"===item.Type&&!item.AlbumArtists&&!item.AlbumArtists.length)return Promise.resolve({TotalRecordCount:0,Items:[]});query=Object.assign({IncludeItemTypes:"MusicAlbum",Recursive:!0,SortBy:"ProductionYear,SortName",SortOrder:"Descending",Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio,ProductionYear"},query);var apiClient=_connectionmanager.default.getApiClient(item);"MusicArtist"===item.Type?query.ContributingArtistIds=item.Id:(query.AlbumArtistIds=item.AlbumArtists[0].Id,query.ExcludeItemIds=item.Id);return apiClient.getItems(apiClient.getCurrentUserId(),query)}.bind(instance),view.parentContainer=section,view.getListOptions=getMoreFromArtistListOptions,view.classList.add("generalItemsContainer"))}(this,view,item),itemMainScrollSlider.push(function(instance,item){var section=instance.view.querySelector(".seriesItemsSection");return"Series"===item.Type?getSeasons.call(instance,{EnableUserData:!1,EnableTotalRecordCount:!1,EnableImages:!1}).then(function(result){instance.seasonItems=result.Items,setScopedFocus(instance.view,section.querySelector(".focusable"),!0);var itemsContainer=section.querySelector(".itemsContainer"),seriesDisplay=(itemsContainer.parentContainer=section,_usersettings.default.seriesDisplay()),hasMultipleSeasons=(_apiclient.default.isLocalItem(item)&&(seriesDisplay=""),instance.hasMultipleSeasons=2<=result.Items.length),seriesDisplay=instance.renderAllEpisodes="episodes"===seriesDisplay||"episodessingleseason"===seriesDisplay&&!hasMultipleSeasons,renderSeasonsWithTabs=seriesDisplay&&hasMultipleSeasons&&_layoutmanager.default.tv,sectionTitleElement=section.querySelector(".sectionTitle"),detailSelectSeason=(sectionTitleElement.innerHTML=seriesDisplay?1===result.Items.length?result.Items[0].Name:_globalize.default.translate("Episodes"):_globalize.default.translate("Seasons"),seriesDisplay&&hasMultipleSeasons?sectionTitleElement.classList.add("hide"):sectionTitleElement.classList.remove("hide"),seriesDisplay?itemsContainer.setAttribute("data-focusabletype","nearest"):itemsContainer.setAttribute("data-focusabletype","autofocus"),section.querySelector(".detailSelectSeason")),detailSelectSeasonContainer=section.querySelector(".detailSelectSeasonContainer"),hasMultipleSeasons=(seriesDisplay&&hasMultipleSeasons&&!renderSeasonsWithTabs?detailSelectSeasonContainer.classList.remove("hide"):detailSelectSeasonContainer.classList.add("hide"),section.querySelector(".seasonTabs"));seriesDisplay?(itemsContainer.classList.add("allEpisodesItemsContainer"),renderSeasonsWithTabs?(sectionTitleElement.closest(".sectionTitleContainer").classList.add("hide"),function(seasonTabsParent,items){var index;items.length?(index=0,items='<div is="emby-tabs" data-index="-1" class="emby-tabs seasonTabs-emby-tabs padded-left padded-left-page padded-right"><div class="emby-tabs-slider scrollSliderX">'+items.map(function(item){var tabClass="emby-button emby-tab-button secondaryText detailSeasonTab",tabClass=(_layoutmanager.default.tv&&(tabClass+=" emby-button-tv"),'<button type="button" is="emby-button" class="'+tabClass+'" data-seasonnumber="'+(null==item.IndexNumber?1:item.IndexNumber)+'" data-id="'+item.Id+'" data-index="'+index+'">'+_textencoding.default.htmlEncode(item.Name)+"</button>");return index++,tabClass}).join("")+"</div></div>",seasonTabsParent.innerHTML=items,seasonTabsParent.classList.remove("hide")):(seasonTabsParent.classList.add("hide"),seasonTabsParent.innerHTML="")}(hasMultipleSeasons,result.Items),instance.seasonTabs=section.querySelector(".seasonTabs-emby-tabs"),instance.seasonTabs.addEventListener("tabchange",function(e){var id,seasonTabs=this.seasonTabs;seasonTabs&&(e=e.detail.selectedTabIndex,seasonTabs=seasonTabs.querySelector('.detailSeasonTab[data-index="'+e+'"]'))&&(id=seasonTabs.getAttribute("data-id"),e=(this.seasonItems||[]).filter(function(s){return s.Id===id})[0])&&scrollEpisodesToSeason(this,e.Id)}.bind(instance))):(sectionTitleElement.closest(".sectionTitleContainer").classList.remove("hide"),hasMultipleSeasons.classList.add("hide"),hasMultipleSeasons.innerHTML="",instance.seasonTabs=null)):(sectionTitleElement.closest(".sectionTitleContainer").classList.remove("hide"),hasMultipleSeasons.innerHTML="",hasMultipleSeasons.classList.add("hide"),instance.seasonTabs=null),(instance.detailSelectSeason=detailSelectSeason)&&(detailSelectSeason.getItems=getSeasons.bind(instance),detailSelectSeason.addEventListener("change",function(e){e=e.target.value;e&&scrollEpisodesToSeason(this,e)}.bind(instance))),itemsContainer.fetchData=function(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item),fields=this.getRequestedItemFields()+",PrimaryImageAspectRatio";if(this.renderAllEpisodes)return fields+=",Overview,PremiereDate,ProductionYear,RunTimeTicks,SpecialEpisodeNumbers",query=Object.assign({UserId:apiClient.getCurrentUserId(),Fields:fields,Recursive:!0,IsFolder:!1,ParentId:item.Id},query),apiClient.isMinServerVersion("4.8")||(query.IncludeItemTypes="Episode"),apiClient.getItems(apiClient.getCurrentUserId(),query);return apiClient.getSeasons(item.Id,Object.assign({UserId:apiClient.getCurrentUserId(),Fields:fields},query))}.bind(instance),itemsContainer.getListOptions=function(items){var includeParentInfoInTitle,fields=["Name"];this.renderAllEpisodes&&!this.hasMultipleSeasons&&(includeParentInfoInTitle=!1);var centerText=!0;this.renderAllEpisodes&&(fields.push("Overview"),fields.push("MediaInfo"),centerText=!1);return{renderer:_cardbuilder.default,options:{shape:"auto",scalable:!0,centerText:centerText,fields:fields,overlayText:!1,focusTransformTitleAdjust:!0,includeParentInfoInTitle:includeParentInfoInTitle},virtualScrollLayout:"horizontal-grid"}}.bind(instance),seriesDisplay&&(itemsContainer.afterRefresh=function(totalResult){if(totalResult.Items.length){var item=this.currentItem;if(item){var view=this.view;if(view){var apiClient,instance=this,itemsContainer=view.querySelector(".childrenItemsContainer");if(itemsContainer)return apiClient=_connectionmanager.default.getApiClient(item),getNextUpItems.call(this,{Limit:1}).then(function(nextUpResult){var nextUpResult=nextUpResult.Items[0],detailSelectSeason=view.querySelector(".detailSelectSeason");if(nextUpResult){onSeriesEpisodeFocusedOrScrolled(instance,nextUpResult);var select,index=itemsContainer.indexOfItemId(nextUpResult.Id);if(-1===index)return nextUpResult={UserId:apiClient.getCurrentUserId(),Limit:0,StartItemId:nextUpResult.Id},apiClient.getEpisodes(item.SeriesId||item.Id,nextUpResult).then(function(result){index=Math.max(totalResult.TotalRecordCount-result.TotalRecordCount,0),itemsContainer.scrollToIndex(Math.min(index,totalResult.TotalRecordCount-1),{behavior:"instant",offset:"-padding-inline-start"},!1)});itemsContainer.scrollToIndex(index,{behavior:"instant",offset:"-padding-inline-start"},!1)}else itemsContainer.scrollToIndex(0,{behavior:"instant",offset:"-padding-inline-start"},!1),detailSelectSeason&&(select=detailSelectSeason).getItems({StartIndex:0,Limit:1}).then(function(result){result.Items.length&&select.setValues([result.Items[0].Id],!1,[result.Items[0]])})})}}}}.bind(instance),(detailSelectSeasonContainer=instance.view.querySelector(".childrenItemsScroller")).addScrollEventListener(function(e){var scrollSize,padding;_layoutmanager.default.tv||(e=e.currentTarget,padding=e.getPadding(),padding=e.getScrollLeft()+padding.inlineStart+padding.inlineEnd,scrollSize=e.getScrollWidth(),padding=Math.min(1,padding/scrollSize),scrollSize=e.querySelector(".childrenItemsContainer"),e=scrollSize.getItems(),(padding=Math.floor(padding*e.length))<e.length&&(e=scrollSize.getItem(padding))&&onSeriesEpisodeFocusedOrScrolled(this,e))}.bind(instance),{}),detailSelectSeasonContainer.addEventListener("focus",function(e){var itemsContainer=e.currentTarget.querySelector(".childrenItemsContainer"),e=e.target.closest(itemsContainer.getItemSelector()),itemsContainer=itemsContainer.getItemFromElement(e);itemsContainer&&onSeriesEpisodeFocusedOrScrolled(this,itemsContainer)}.bind(instance),!0))}):(section.classList.add("hide"),Promise.resolve())}(this,item)),function(instance,view,item,apiClient){var headerText;"MusicArtist"!==item.Type||(headerText=view.querySelector(".artistSongsItemsHeader"),apiClient=_approuter.default.getRouteUrl("list",{serverId:apiClient.serverId(),itemTypes:"Audio",artistId:item.Id}),item="",item='<a is="emby-sectiontitle" href="'+apiClient+'" class="button-link  button-link-color-inherit sectionTitleTextButton">',item=(item=(item+='<h2 class="sectionTitle sectionTitle-cards">')+_globalize.default.translate("Songs"))+"</h2></a>",headerText.innerHTML=item,(apiClient=view.querySelector(".artistSongsItemsContainer")).classList.add("generalItemsContainer"),apiClient.fetchData=function(query){var item=this.currentItem,item=_connectionmanager.default.getApiClient(item);return item.getItems(item.getCurrentUserId(),Object.assign({Recursive:!0,IncludeItemTypes:"Audio",ArtistIds:this.currentItem.Id,SortBy:"PlayCount,SortName",SortOrder:"Descending,Ascending",ImageTypeLimit:1,Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio"},query))}.bind(instance),apiClient.getListOptions=getArtistSongsListOptions,apiClient.parentContainer=apiClient.closest(".verticalSection"),_layoutmanager.default.tv)||((headerText=apiClient.parentContainer.querySelector(".sectionTitleContainer")).classList.remove("sectionTitleContainer-cards"),headerText.classList.add("sectionTitleContainer-wrappedlistview"))}(this,view,item,responses),function(instance,item,apiClient){var section=instance.view.querySelector(".artistAlbumsSection"),itemsContainer=section.querySelector(".itemsContainer"),apiClient=(itemsContainer.parentContainer=section,_approuter.default.getRouteUrl("list",{serverId:apiClient.serverId(),itemTypes:"MusicAlbum",albumArtistId:item.Id}));section.querySelector(".sectionTitleTextButton").href=apiClient,itemsContainer.setAttribute("data-virtualscrolllayout","horizontal-grid"),itemsContainer.fetchData=function(query){var item=this.currentItem;if("MusicArtist"!==item.Type)return Promise.resolve({Items:[],TotalRecordCount:0});var apiClient=_connectionmanager.default.getApiClient(item);return(query=Object.assign({IncludeItemTypes:"MusicAlbum",Recursive:!0,SortBy:"ProductionYear,SortName",SortOrder:"Descending,Ascending",ImageTypeLimit:1,Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio,ProductionYear"},query)).AlbumArtistIds=item.Id,apiClient.getItems(apiClient.getCurrentUserId(),query)}.bind(instance),itemsContainer.getListOptions=getMusicArtistChildrenListOptions}(this,item,responses),function(instance,item,apiClient){var trackList=instance.view.querySelector(".trackList");trackList.parentContainer=trackList,"Season"===item.Type?(trackList.fetchData=function(serverId,seriesId,seasonId){return function(query){var apiClient=_connectionmanager.default.getApiClient(serverId);return apiClient.getEpisodes(seriesId,Object.assign({SeasonId:seasonId,ImageTypeLimit:1,UserId:apiClient.getCurrentUserId(),Fields:"Overview,PrimaryImageAspectRatio,PremiereDate,ProductionYear,SyncStatus"},query))}}(apiClient.serverId(),item.SeriesId,item.Id),trackList.getListOptions=function(item){return function(){return{renderer:_listview.default,options:{showIndexNumber:!1,imageSize:"large",highlight:!1,action:"link",imagePlayButton:!_layoutmanager.default.tv,includeParentInfoInTitle:!1,enableSpecialEpisodePrefix:0!==item.IndexNumber,fields:["Name","Overview"]},virtualScrollLayout:"vertical-list"}}}(item),trackList.setAttribute("data-virtualscrolllayout","vertical-grid"),trackList.classList.add("padded-bottom-page")):"MusicAlbum"===item.Type?(trackList.fetchData=function(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item),includeOverview=!0===item.SupportsResume,fields=this.getRequestedItemFields()+",PrimaryImageAspectRatio,SyncStatus";includeOverview&&(fields+=",Overview");return apiClient.getItems(apiClient.getCurrentUserId(),Object.assign({ParentId:item.Id,Fields:fields,ImageTypeLimit:1,SortBy:null,EnableTotalRecordCount:!1}))}.bind(instance),trackList.getListOptions=(!0===item.SupportsResume?function(item){return function(items){var fields=[];return function(items){for(var i=0,length=items.length;i<length;i++){var item=items[i];if("Audio"!==item.MediaType||item.SupportsResume)return 1}return}(items)&&fields.push("Overview"),"Playlist"===item.Type&&fields.push("ParentName"),fields.push("Name"),{renderer:_listview.default,options:{showIndexNumberLeft:!1,highlight:!1,action:"link",dragReorder:!1,image:!0,imageSize:"medium",showIndexNumber:!0,artist:"auto",imagePlayButton:!_layoutmanager.default.tv,showIndex:"MusicAlbum"===item.Type,fields:fields,index:function(items){for(var discs={},numDiscs=0,i=0,length=items.length;i<length;i++){var item=items[i];null==item.ParentIndexNumber||discs[item.ParentIndexNumber]||(discs[item.ParentIndexNumber]=!0,numDiscs++)}return 1<numDiscs}(items)?"disc":null,containerAlbumArtists:"MusicAlbum"===item.Type?item.AlbumArtists:null,playAction:"playallfromhere",includeParentInfoInTitle:!1,autoHideMediaInfo:!1,enableSideMediaInfo:!0},virtualScrollLayout:"vertical-list",commandOptions:{openAlbum:!1}}}}:getPlaylistListOptionsFn)(item),trackList.classList.add("generalItemsContainer")):"Playlist"===item.Type&&(trackList.fetchData=function(query){var currentItem=this.currentItem,apiClient=_connectionmanager.default.getApiClient(currentItem),itemId=currentItem.Id,currentItem=_usersettings.default.itemSortBy(itemId)||"default";"default"===currentItem&&(currentItem="ListItemOrder");var sortOrder=currentItem?_usersettings.default.itemSortOrder(itemId):null;return apiClient.getItems(apiClient.getCurrentUserId(),Object.assign({ParentId:itemId,Fields:"PrimaryImageAspectRatio,Overview,PremiereDate,ProductionYear,OfficialRating,CommunityRating,SyncStatus",ImageTypeLimit:1,SortBy:currentItem,SortOrder:sortOrder},query)).then(function(result){for(var i=0,length=result.Items.length;i<length;i++)result.Items[i].PlaylistId=itemId;return result})}.bind(instance),trackList.getListOptions=getPlaylistListOptionsFn(item),trackList.setAttribute("data-monitor","PlaylistItems"),trackList.setAttribute("data-monitorids",item.Id),trackList.setAttribute("data-virtualscrolllayout","vertical-grid"),trackList.classList.add("padded-bottom-page"),trackList.afterRefresh=function(){var item=this.currentItem,sortItems=getSortMenuOptions(item),view=this.view,item=_usersettings.default.itemSortBy(item.Id)||"default",sortItems=getSortMenuOption(sortItems,item),item=view.querySelector(".btnSortItems");item.setAttribute("title",_globalize.default.translate("SortByValue",(null==sortItems?void 0:sortItems.name)||"")),item.setAttribute("aria-label",_globalize.default.translate("SortByValue",(null==sortItems?void 0:sortItems.name)||"")),item.querySelector(".btnSortText").innerHTML=_globalize.default.translate("HeaderSortBy")}.bind(instance),trackList.classList.add("generalItemsContainer"));"Playlist"===item.Type||"MusicAlbum"===item.Type?trackList.classList.add("tracklist-topmargin"):trackList.classList.remove("tracklist-topmargin");_layoutmanager.default.tv&&"Season"===item.Type?trackList.classList.add("tracklist-sidemargin"):trackList.classList.remove("tracklist-sidemargin");"Season"===item.Type||"MusicAlbum"===item.Type&&!_layoutmanager.default.tv||"Playlist"===item.Type&&!_layoutmanager.default.tv?trackList.classList.add("trackList-marginleftcards"):trackList.classList.remove("trackList-marginleftcards")}(this,item,responses),function(instance,view,item,user){if(_itemmanager.default.canAddToCollection(item,user)||_itemmanager.default.canAddToPlaylist(item)){switch(item.Type){case"Season":case"Person":case"Genre":case"MusicGenre":case"GameGenre":case"BoxSet":case"Playlist":case"Folder":case"CollectionFolder":case"UserView":case"GameSystem":case"Studio":case"PhotoAlbum":case"Program":case"Channel":case"TvChannel":return}user=view.querySelector(".appearsOnListsItemsContainer");user.fetchData=function(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item);return query=Object.assign({fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio",IncludeItemTypes:"Playlist,BoxSet",Recursive:!0,SortBy:"SortName",ListItemIds:item.Id},query),apiClient.getItems(apiClient.getCurrentUserId(),query)}.bind(instance),user.getListOptions=getAppearsOnListsListOptions,user.parentContainer=user.closest(".verticalSection"),user.classList.add("generalItemsContainer")}}(this,view,item,user),function(instance,view){view=view.querySelector(".peopleItemsContainer");view.fetchData=function(instance){return function(query){var serverId=instance.currentItem.ServerId,people=(instance.currentItem.People||[]).map(function(p){return(p=Object.assign({},p)).ServerId=serverId,"Person"!==p.Type&&(p.PersonType=p.Type,p.Type="Person"),p}),totalRecordCount=people.length;return query&&(people=people.slice(query.StartIndex||0),query.Limit)&&people.length>query.Limit&&(people.length=query.Limit),Promise.resolve({Items:people,TotalRecordCount:totalRecordCount})}}(instance),view.parentContainer=view.closest(".verticalSection"),view.getListOptions=getPeopleListOptions,view.classList.add("generalItemsContainer")}(this,view),function(instance,view,item){_itemhelper.default.supportsSimilarItems(item)&&((view=view.querySelector(".similarItemsContainer")).fetchData=function(){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item),options={Limit:12,UserId:apiClient.getCurrentUserId(),ImageTypeLimit:1,Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio,ProductionYear,Status,EndDate",EnableTotalRecordCount:!1};("Program"===item.Type||"Timer"===item.Type&&item.ProgramId&&!item.IsSports)&&(options.GroupProgramsBySeries=!0);"MusicAlbum"===item.Type&&item.AlbumArtists&&item.AlbumArtists.length&&(options.ExcludeArtistIds=item.AlbumArtists[0].Id);item="Timer"===item.Type?item.ProgramId:item.Id;return apiClient.getSimilarItems(item,options)}.bind(instance),view.parentContainer=view.closest(".verticalSection"),view.getListOptions=function(item){return function(items){var fields=["Name"];return"Movie"!==item.Type&&"Trailer"!==item.Type&&"Program"!==item.Type&&"Game"!==item.Type&&"Series"!==item.Type||fields.push("ProductionYear"),"MusicAlbum"!==item.Type&&"Game"!==item.Type||fields.push("ParentName"),"Program"===item.Type&&fields.unshift("ParentName"),{renderer:_cardbuilder.default,options:{shape:"auto",lines:"Game"===item.Type?3:"Program"===item.Type?2:null,centerText:!0,fields:fields,overlayPlayButton:!0,overlayText:!1,multiSelect:"Program"!==item.Type&&"Timer"!==item.Type,contextMenu:"Program"!==item.Type&&"Timer"!==item.Type,draggable:"Program"!==item.Type&&"Timer"!==item.Type,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}}(item),view.classList.add("generalItemsContainer"))}(this,view,item),function(instance,view,item,apiClient){_itemhelper.default.supportsSimilarItemsOnLiveTV(item,apiClient)&&((item=view.querySelector(".similarOnLiveTVItemsContainer")).fetchData=function(){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item);return apiClient.getSimilarItems(item.Id,{userId:apiClient.getCurrentUserId(),limit:12,fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio,ProductionYear",IncludeItemTypes:"Program",EnableTotalRecordCount:!1,GroupProgramsBySeries:!0})}.bind(instance),item.parentContainer=item.closest(".verticalSection"),item.getListOptions=getMoreLikeThisOnLiveTVListOptions,item.classList.add("generalItemsContainer"))}(this,view,item,responses),function(instance,view,item){("Series"===item.Type||"Program"===item.Type||"Timer"===item.Type&&item.ProgramId)&&((view=view.querySelector(".seriesScheduleItemsContainer")).fetchData=function(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item);query=Object.assign({UserId:apiClient.getCurrentUserId(),HasAired:!1,SortBy:"StartDate",ImageTypeLimit:1,EnableImageTypes:"Primary,Thumb,Backdrop",EnableUserData:!1,Fields:"PrimaryImageAspectRatio,ChannelInfo"},query),"Program"===item.Type||"Timer"===item.Type&&item.ProgramId?item.AsSeries?query.SeriesFromProgramId=item.Id:(query.ShowingsFromProgramId=item.ProgramId||item.Id,query.ExcludeItemIds=item.ProgramId||item.Id):query.LibrarySeriesId=item.Id;return apiClient.getLiveTvPrograms(query)}.bind(instance),view.parentContainer=view.closest(".verticalSection"),view.getListOptions=function(items){return{renderer:_cardbuilder.default,options:{preferThumb:"auto",shape:"autooverflow",fields:["Name","ChannelName","AirTime"],centerText:!0,overlayText:!1,overlayPlayButton:!1,showAirDateTime:!0,multiSelect:!1,draggable:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}.bind(instance),view.classList.add("generalItemsContainer"),"Program"!==item.Type&&"Timer"!==item.Type||(item.AsSeries?view.parentContainer.querySelector(".sectionTitle").innerHTML=_globalize.default.translate("Showings"):view.parentContainer.querySelector(".sectionTitle").innerHTML=_globalize.default.translate("HeaderOtherShowings")))}(this,view,item),function(instance,view,item){_itemhelper.default.supportsExtras(item)&&((item=view.querySelector(".extrasItemsContainer")).fetchData=function(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item);return apiClient.getSpecialFeatures(apiClient.getCurrentUserId(),item.Id,{Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio"}).then(function(items){var totalRecordCount=items.length;return query&&(items=items.slice(query.StartIndex||0),query.Limit)&&items.length>query.Limit&&(items.length=query.Limit),{Items:items,TotalRecordCount:totalRecordCount}})}.bind(instance),item.parentContainer=item.closest(".verticalSection"),item.getListOptions=getExtrasListOptions,item.classList.add("generalItemsContainer"))}(this,view,item),function(instance,view,item,apiClient){switch(item.Type){case"Genre":case"MusicGenre":case"GameGenre":case"Person":case"Studio":case"MusicArtist":case"Tag":case"BoxSet":break;default:return}instance._linkedItemsView||(instance._linkedItemsView=new _linkeditems.default({view:view.querySelector(".linkedItems"),params:instance.params,item:item,apiClient:apiClient,requestedItemFields:instance.getRequestedItemFields()}))}(this,view,item,responses),function(instance,view,item){var section=view.querySelector(".chaptersSection"),html="";"Audio"===item.MediaType?(html+='<div is="emby-itemscontainer" class="focuscontainer-x trackList-marginleftcards itemsContainer chaptersItemsContainer vertical-list padded-left padded-left-page padded-right"></div>',section.classList.remove("verticalSection-cards"),section.classList.add("verticalSection-extrabottompadding"),(sectionTitleContainer=section.querySelector(".sectionTitleContainer")).classList.add("trackList-marginleftcards"),sectionTitleContainer.classList.remove("sectionTitleContainer-cards"),section.querySelector(".sectionTitle").classList.remove("sectionTitle-cards")):html=(html+='<div is="emby-scroller" class="emby-scroller padded-top-focusscale padded-bottom-focusscale padded-left padded-left-page padded-right" data-mousewheel="false" data-focusscroll="true" data-horizontal="true">')+'<div is="emby-itemscontainer" class="scrollSlider focuscontainer-x itemsContainer chaptersItemsContainer focusable" data-focusabletype="nearest" data-virtualscrolllayout="horizontal-grid"></div></div>';section.insertAdjacentHTML("beforeend",html);var sectionTitleContainer=view.querySelector(".chaptersItemsContainer");sectionTitleContainer.fetchData=function(query){var item=this.currentItem,mediaSourceId=this.view.querySelector(".selectSource").value,mediaSource=(this._currentPlaybackMediaSources||[]).filter(function(m){return m.Id===mediaSourceId})[0]||{},chapters=(null===mediaSource?void 0:mediaSource.Chapters)||item.Chapters||[];chapters.length&&"Video"===item.MediaType&&!chapters[0].ImageTag&&(chapters=[]);var videoStream=(mediaSource.MediaStreams||[]).filter(function(i){return"Video"===i.Type})[0]||{},aspect=null;videoStream.Width&&videoStream.Height&&(aspect=videoStream.Width/videoStream.Height);for(var i=0,length=chapters.length;i<length;i++){var chapter=chapters[i];chapter.ServerId=item.ServerId,chapter.MediaType=item.MediaType,chapter.PrimaryImageAspectRatio=aspect,null==chapter.ItemId&&(chapter.ItemId=item.Id),chapter.MediaSourceId=mediaSource.Id,chapter.Type="Chapter",chapter.Id="chapter_"+chapter.ItemId+"_"+chapter.StartPositionTicks,null==chapter.ChapterIndex&&(chapter.ChapterIndex=i)}videoStream=(chapters=function(chapters){for(var list=[],i=0,length=chapters.length;i<length;i++){var chapter=chapters[i];chapter.MarkerType&&"Chapter"!==chapter.MarkerType||list.push(chapter)}return list}(chapters)).length;query&&(chapters=chapters.slice(query.StartIndex||0),query.Limit)&&chapters.length>query.Limit&&(chapters.length=query.Limit);return Promise.resolve({Items:chapters,TotalRecordCount:videoStream})}.bind(instance),sectionTitleContainer.parentContainer=sectionTitleContainer.closest(".verticalSection"),"Audio"===item.MediaType?sectionTitleContainer.getListOptions=getChaptersListViewOptions:sectionTitleContainer.getListOptions=getChaptersCardOptions}(this,view,item),function(instance,view){view=view.querySelector(".additionalPartsItemsContainer");view.fetchData=function(){var item=this.currentItem;if((item.PartCount||1)<2)return Promise.resolve({TotalRecordCount:0,Items:[]});var apiClient=_connectionmanager.default.getApiClient(item);return apiClient.getAdditionalVideoParts(apiClient.getCurrentUserId(),item.Id)}.bind(instance),view.parentContainer=view.closest(".verticalSection"),view.getListOptions=getAdditionalPartsListOptions,view.classList.add("generalItemsContainer")}(this,view),function(instance,view,item){"TvChannel"===item.Type&&((item=view.querySelector(".programGuideItemsContainer")).fetchData=function(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item);return apiClient.getLiveTvPrograms(Object.assign({ChannelIds:item.Id,UserId:apiClient.getCurrentUserId(),HasAired:!1,SortBy:"StartDate",ImageTypeLimit:1,EnableUserData:!1,Fields:"PrimaryImageAspectRatio,Overview"},query))}.bind(instance),item.parentContainer=item.closest(".programGuideSection"),item.getListOptions=function(items){var smallerLayout="true"===this.params.asDialog&&_layoutmanager.default.tv,fields=["ParentName","Name","StartToEndDateTime"];smallerLayout||fields.push("Overview");return{renderer:_listview.default,options:{imageSize:smallerLayout?"medium":"large",enableUserDataButtons:!1,mediaInfo:!1,mediaInfoWithTitle:!0,draggable:!1,multiSelect:!1,defaultShape:"portrait",fields:fields},virtualScrollLayout:"vertical-grid"}}.bind(instance),item.classList.add("generalItemsContainer"))}(this,view,item),function(instance,view,item){"SeriesTimer"===item.Type&&((item=view.querySelector(".seriesTimerScheduleItemsContainer")).fetchData=function(){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item);return apiClient.getLiveTvTimers({UserId:apiClient.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb",SortBy:"StartDate",EnableTotalRecordCount:!1,EnableUserData:!1,SeriesTimerId:item.Id,Fields:"ChannelInfo,ChannelImage"})}.bind(instance),item.parentContainer=item.closest(".verticalSection"),item.getListOptions=getSeriesTimerListOptions,item.classList.add("generalItemsContainer"))}(this,view,item),function(instance,view,item){var itemsContainer=function(view,item){var sideImageContainer=view.querySelector(".detailImageContainer-side"),view=view.querySelector(".detailImageContainer-main");return enableTrackList(item)?(view.classList.add("hide"),sideImageContainer.classList.remove("hide"),sideImageContainer):(view.classList.remove("hide"),sideImageContainer.classList.add("hide"),view)}(view,item),detailImage=itemsContainer,view=view.querySelector(".detailImageContainer-main");enableTrackList(item)||"Person"!==item.Type&&"BoxSet"!==item.Type&&"Season"!==item.Type&&"TvChannel"!==item.Type&&"Playlist"!==item.Type&&"MusicGenre"!==item.Type||detailImage.classList.add("detailImageContainer-small");"Season"!==item.Type&&("Playlist"!==item.Type&&"MusicAlbum"!==item.Type||enableTrackList(item))||view.classList.add("detailImageContainer-main-extrabottommargin");_layoutmanager.default.tv?view.classList.add("detailImageContainer-main-tv"):view.classList.remove("detailImageContainer-main-tv");enableItemBackdropAsTopImage(item)?view.classList.add("detailImageContainer-hidemobile"):view.classList.remove("detailImageContainer-hidemobile");view=_imagehelper.default.getShape([item],{});detailImage.classList.remove("detailImageContainer-backdrop","detailImageContainer-square","detailImageContainer-portrait","detailImageContainer-fourThree","detailImageContainer-banner"),view&&detailImage.classList.add("detailImageContainer-"+view);itemsContainer.fetchData=function(){var item=this.currentItem,items=[];item&&enableDetailPoster(this,item)&&items.push(item);return Promise.resolve({Items:items,TotalRecordCount:items.length})}.bind(instance),(itemsContainer.parentContainer=itemsContainer).getListOptions=function(itemType,cardClass,imageContainerClassName){imageContainerClassName=imageContainerClassName.split(" ").filter(function(c){return c.includes("detailImage")}).join(" ");var cardBoxClass="detailImageContainerCard-cardBox";imageContainerClassName.includes("detailImageContainer-side")&&(imageContainerClassName+=" item-fixed-side",cardBoxClass+=" detailImageContainerCard-side-cardBox");return imageContainerClassName+=" imageWidthTest",function(items){return{renderer:_cardbuilder.default,options:{overlayText:!0,fields:[],action:"none",imageClass:"detailImage",imageWidthTestClass:imageContainerClassName,multiSelect:!1,contextMenu:!1,ratingButton:!1,playedButton:!1,cardClass:cardClass,cardBoxClass:cardBoxClass,defaultIcon:!0,typeIndicator:!1,playedIndicator:!1,syncIndicator:!1,timerIndicator:!1,randomDefaultBackground:!1,staticElement:!0,progress:"Program"===itemType||"Timer"===itemType,enableUserData:!1,draggable:!1,moreButton:!1,programIndicators:!1,keepImageAnimation:!0},virtualScrollLayout:"vertical-grid"}}}(item.Type,"detailImageContainerCard",detailImage.className),itemsContainer.afterRefresh=afterDetailImageRefreshed,itemsContainer.classList.add("generalItemsContainer"),enableDetailPoster(instance,item)||itemsContainer.classList.add("hide")}(this,view,item)),!function(view){var elem=view.querySelector(".chaptersItemsContainer");elem.waitForCustomElementUpgrade().then(function(){elem.resume({})})}(this.view),view.querySelector(".details-additionalContent")),asDialog=("TvChannel"===item.Type||"Playlist"===item.Type||"Season"===item.Type?detailMainContainerParent.classList.remove("padded-bottom-page"):detailMainContainerParent.classList.add("padded-bottom-page"),this.mainSection),setNewBackdrop=(willHaveBackdrop?(detailMainContainerParent.classList.add("details-additionalContent-withbackdrop"),asDialog.classList.add("detailMainContainer-withbackdrop")):(detailMainContainerParent.classList.remove("details-additionalContent-withbackdrop"),asDialog.classList.remove("detailMainContainer-withbackdrop")),enableTrackList(item)?("Season"===item.Type?setTitle(item):setTitle(item,0,_layoutmanager.default.tv),view.querySelector(".detailTextContainer").classList.add("detailTextContainer-tracklist")):(setTitle(item,0,"float"===getLogoPlacement(item)&&"MusicAlbum"!==item.Type),view.querySelector(".detailTextContainer").classList.remove("detailTextContainer-tracklist")),view.querySelector(".topDetailsMain")),backdropOptions=view.querySelector(".item-fixed-side"),mainDetailButtons=view.querySelector(".mainDetailButtons");return _layoutmanager.default.tv||mainDetailButtons.classList.add("detailButtons-margin"),enableTrackList(item)?(setNewBackdrop.classList.remove("topDetailsMain-graphic","topDetailsMain-graphic-tv"),asDialog.classList.remove("detailMainContainer-withitembackdrop","detailMainContainer-vertical"),backdropOptions.classList.remove("hide"),_layoutmanager.default.tv&&"Season"!==item.Type?setNewBackdrop.classList.add("padded-left","padded-left-page","padded-right"):setNewBackdrop.classList.remove("padded-left","padded-left-page","padded-right")):(enableItemBackdropAsTopImage(item)?(asDialog.classList.add("detailMainContainer-withitembackdrop"),asDialog.classList.remove("detailMainContainer-vertical")):(asDialog.classList.remove("detailMainContainer-withitembackdrop"),asDialog.classList.add("detailMainContainer-vertical")),enableTvDetailImageLayout(this,item)?_layoutmanager.default.tv?setNewBackdrop.classList.add("topDetailsMain-graphic","topDetailsMain-graphic-tv"):(setNewBackdrop.classList.add("topDetailsMain-graphic"),setNewBackdrop.classList.remove("topDetailsMain-graphic-tv")):setNewBackdrop.classList.remove("topDetailsMain-graphic","topDetailsMain-graphic-tv"),backdropOptions.classList.add("hide"),setNewBackdrop.classList.remove("padded-left","padded-left-page","padded-right")),function(instance,item,apiClient,user,containers){var parentRoute,itemForTitle="Timer"===item.Type&&item.ProgramInfo||item,context=inferContext(itemForTitle),parentNameHtml=[],parentNameLast=!1,hasFocusableButton=!1,fontSize=parseFloat(window.getComputedStyle(document.body,null).getPropertyValue("font-size")),fontSize=Math.round(2*fontSize*2.4)+Math.round(.2*fontSize),apiClient="title"!==getLogoPlacement(itemForTitle)?null:apiClient.getLogoImageUrl(itemForTitle,{maxHeight:Math.max(fontSize,260)},_skinmanager.default.getPreferredLogoImageTypes()),fontSize="itemName-primary",itemPrimaryNameContainerClass="itemPrimaryNameContainer",html=(itemForTitle.AlbumArtists&&itemForTitle.AlbumArtists.length?(parentNameHtml.push(getArtistLinksHtml(itemForTitle.AlbumArtists,itemForTitle.ServerId)),parentNameLast=!0):itemForTitle.ArtistItems&&itemForTitle.ArtistItems.length&&"MusicVideo"===itemForTitle.Type?(parentNameHtml.push(getArtistLinksHtml(itemForTitle.ArtistItems,itemForTitle.ServerId)),parentNameLast=!0):itemForTitle.GameSystem&&itemForTitle.GameSystemId?(parentRoute=_approuter.default.getRouteUrl({Id:itemForTitle.GameSystemId,Name:itemForTitle.GameSystem,Type:"GameSystem",IsFolder:parentNameLast=!0,ServerId:itemForTitle.ServerId},{context:context}),hasFocusableButton=!0,parentNameHtml.push('<a style="font-weight:inherit;" class="button-link button-link-color-inherit" is="emby-linkbutton" href="'+parentRoute+'">'+_textencoding.default.htmlEncode(itemForTitle.GameSystem)+"</a>")):itemForTitle.SeriesName&&itemForTitle.SeriesId?(parentRoute=_approuter.default.getRouteUrl({Id:itemForTitle.SeriesId,Name:itemForTitle.SeriesName,Type:"Series",IsFolder:!0,ServerId:itemForTitle.ServerId},{context:context}),seriesName=_textencoding.default.htmlEncode(itemForTitle.SeriesName),apiClient?(fontSize+=" itemName-primary-logo",_layoutmanager.default.tv&&(fontSize+=" itemName-primary-logo-tv"),itemPrimaryNameContainerClass+=" itemPrimaryNameContainer-logo",hasFocusableButton=!0,parentNameHtml.push('<a style="font-weight:inherit;height:100%;width:100%;" class="button-link button-link-color-inherit" is="emby-linkbutton" href="'+parentRoute+'">'+(seriesName='<img draggable="false" loading="lazy"'+decodingAttribute+' class="itemLogoAsTitle" alt="'+seriesName+'" src="'+apiClient+'" />')+"</a>")):(hasFocusableButton=!0,parentNameHtml.push('<a style="font-weight:inherit;" class="button-link button-link-color-inherit" is="emby-linkbutton" href="'+parentRoute+'">'+seriesName+"</a>"))):itemForTitle.SeriesName?parentNameHtml.push(_textencoding.default.htmlEncode(itemForTitle.SeriesName)):(itemForTitle.IsSeries||itemForTitle.EpisodeTitle)&&parentNameHtml.push(_textencoding.default.htmlEncode(itemForTitle.Name)),itemForTitle.Album&&itemForTitle.AlbumId&&("MusicVideo"===itemForTitle.Type||"Audio"===itemForTitle.Type)?(parentRoute=_approuter.default.getRouteUrl({Id:itemForTitle.AlbumId,Name:itemForTitle.Album,Type:"MusicAlbum",IsFolder:!0,ServerId:itemForTitle.ServerId},{context:context}),hasFocusableButton=!0,parentNameHtml.push('<a style="font-weight:inherit;" class="button-link button-link-color-inherit" is="emby-linkbutton" href="'+parentRoute+'">'+_textencoding.default.htmlEncode(itemForTitle.Album)+"</a>")):itemForTitle.Album&&parentNameHtml.push(_textencoding.default.htmlEncode(itemForTitle.Album)),""),seriesName="";_layoutmanager.default.tv||(_itemmanager.default.canEdit([item],user)&&(hasFocusableButton=!0,seriesName+='<button is="paper-icon-button-light" class="btnDetailEdit btnEditMetadata secondaryText flex-shrink-zero" title="'+_globalize.default.translate("HeaderEditMetadata")+'" aria-label="'+_globalize.default.translate("HeaderEditMetadata")+'"><i class="md-icon autortl">&#xe3c9;</i></button>'),_itemmanager.default.canEditImages(item,user)&&(hasFocusableButton=!0,seriesName+='<button is="paper-icon-button-light" class="btnDetailEdit btnEditImages secondaryText flex-shrink-zero" title="'+_globalize.default.translate("HeaderEditImages")+'" aria-label="'+_globalize.default.translate("HeaderEditImages")+'"><i class="md-icon">photo</i></button>')),enableItemBackdropAsTopImage(itemForTitle)||(itemPrimaryNameContainerClass+=" itemPrimaryNameContainer-centered"),parentNameHtml.length&&(html=parentNameLast?'<div class="verticalFieldItem itemSecondaryNameContainer"><h3 class="itemName-secondary itemSecondaryNameContainer-condense">'+parentNameHtml.join(" - ")+"</h3></div>":'<div class="verticalFieldItem '+itemPrimaryNameContainerClass+'"><h1 class="'+fontSize+'">'+parentNameHtml.join(" - ")+"</h1></div>"),context=(context=_itemmanager.default.getDisplayName(itemForTitle,{includeParentInfo:!0}))&&_textencoding.default.htmlEncode(context),html&&context&&!parentNameLast?html+='<div class="verticalFieldItem flex align-items-center flex-wrap-wrap itemSecondaryNameContainer"><h3 class="itemName-secondary">'+context+"</h3>"+seriesName+"</div>":(parentNameLast||(apiClient&&(context='<img draggable="false" loading="lazy"'+decodingAttribute+' class="itemLogoAsTitle" alt="'+context+'" src="'+apiClient+'" />',fontSize+=" itemName-primary-logo",itemPrimaryNameContainerClass+=" itemPrimaryNameContainer-logo",_layoutmanager.default.tv)&&(fontSize+=" itemName-primary-logo-tv"),context)||seriesName)&&(html='<div class="verticalFieldItem flex align-items-center flex-wrap-wrap '+itemPrimaryNameContainerClass+'"><h1 class="'+fontSize+'">'+context+"</h1>"+seriesName+"</div>"+html);for(var i=0,length=containers.length;i<length;i++){var container=containers[i],btnEditMetadata=(enableItemBackdropAsTopImage(itemForTitle)?container.classList.remove("nameContainer-centered"):container.classList.add("nameContainer-centered"),container.innerHTML=html,setScopedFocus(null,container,hasFocusableButton),html.length?container.classList.remove("hide"):container.classList.add("hide"),container.querySelector(".btnEditMetadata")),btnEditMetadata=(btnEditMetadata&&btnEditMetadata.addEventListener("click",onEditMetadataClick.bind(instance)),container.querySelector(".btnEditImages"));btnEditMetadata&&btnEditMetadata.addEventListener("click",onEditImagesClick.bind(instance))}}(this,item,responses,user,view.querySelectorAll(".nameContainer")),function(view,item,apiClient){var imgUrl,usePrimaryImage,screenWidth=screen.availWidth,itemBackdropContainerElement=view.querySelector(".itemBackdropContainer"),itemBackdropElement=itemBackdropContainerElement.querySelector(".itemBackdrop");enableItemBackdropAsTopImage(item)?(itemBackdropContainerElement.classList.remove("hide"),usePrimaryImage="Video"===item.MediaType&&"Movie"!==item.Type&&"Trailer"!==item.Type||item.MediaType&&"Video"!==item.MediaType||"MusicAlbum"===item.Type||"Playlist"===item.Type,"Program"===item.Type&&item.ImageTags&&item.ImageTags.Thumb?imgUrl=apiClient.getImageUrl(item.Id,{type:"Thumb",index:0,maxWidth:screenWidth,tag:item.ImageTags.Thumb,EnableImageEnhancers:!1}):usePrimaryImage&&item.ImageTags&&item.ImageTags.Primary?imgUrl=apiClient.getImageUrl(item.Id,{type:"Primary",index:0,maxWidth:screenWidth,tag:item.ImageTags.Primary,EnableImageEnhancers:!1}):item.BackdropImageTags&&item.BackdropImageTags.length?imgUrl=apiClient.getImageUrl(item.Id,{type:"Backdrop",index:0,maxWidth:screenWidth,tag:item.BackdropImageTags[0]}):item.ParentBackdropItemId&&item.ParentBackdropImageTags&&item.ParentBackdropImageTags.length?imgUrl=apiClient.getImageUrl(item.ParentBackdropItemId,{type:"Backdrop",index:0,tag:item.ParentBackdropImageTags[0],maxWidth:screenWidth}):item.ImageTags&&item.ImageTags.Thumb?imgUrl=apiClient.getImageUrl(item.Id,{type:"Thumb",index:0,maxWidth:screenWidth,tag:item.ImageTags.Thumb,EnableImageEnhancers:!1}):item.ImageTags&&item.ImageTags.Primary&&(imgUrl=apiClient.getImageUrl(item.Id,{type:"Primary",index:0,maxWidth:screenWidth,tag:item.ImageTags.Primary,EnableImageEnhancers:!1})),"TvChannel"===item.Type&&itemBackdropContainerElement.classList.add("itemBackdropContainer-small"),usePrimaryImage=view.querySelector(".itemMainScrollSlider"),_layoutmanager.default.tv?usePrimaryImage.classList.remove("itemMainScrollSlider-moveup","itemMainScrollSlider-nopaddingtop"):"TvChannel"!==item.Type&&enableItemBackdropAsTopImage(item)&&usePrimaryImage.classList.add("itemMainScrollSlider-nopaddingtop"),"TvChannel"!==item.Type&&"Person"!==item.Type||itemBackdropElement.classList.add("itemBackdrop-contain"),itemBackdropElement.style.backgroundImage=imgUrl?"url('"+imgUrl+"')":""):itemBackdropContainerElement.classList.add("hide")}(view,item,responses),renderTrackSelections(view,this,item,user,!0,itemInfo),itemMainScrollSlider.push(renderDetails(this,view,item,0,user)),function(view,user,item){if(_servicelocator.appHost.supports("sync"))for(var canSync=_itemmanager.default.canSync(item,user),buttons=view.querySelectorAll(".btnSyncDownload"),i=0,length=buttons.length;i<length;i++)buttons[i].setItem(item),canSync&&!_layoutmanager.default.tv?buttons[i].classList.remove("hide"):buttons[i].classList.add("hide")}(view,user,item),Promise.all(itemMainScrollSlider).then(function(){return enableTrackList(item)||function(elem){for(var btns=elem.querySelectorAll(".detailButton"),i=0,length=btns.length;i<length;i++){var btn=btns[i];if(_focusmanager.default.isCurrentlyFocusable(btn))return setScopedFocus(null,elem,!0,"autofocus")}setScopedFocus(null,elem,!1,"autofocus")}(mainDetailButtons),[item,user]})}function onItemFetchError(instance,errorResponse,apiClient){return Emby.importModule("./modules/common/responsehelper.js").then(function(responseHelper){return responseHelper.getErrorInfo(errorResponse).then(function(errorInfo){var view=instance.view;view.querySelector(".details-additionalContent").classList.add("hide");html="<div><p>",apiClient.isMinServerVersion("4.8.4")?html+=errorInfo.text:html+="Content no longer available.",html+="</p>";var errorInfo=_approuter.default.getRouteUrl("home",{serverId:apiClient.serverId()}),html=(html+='<a href="'+errorInfo+'" is="emby-linkbutton" class="raised btnHomeItemNotFound" style="margin:0;">')+_globalize.default.translate("Home")+"</a></div>";return view.querySelector(".detailMainContainer").innerHTML=html,_focusmanager.default.focus(view.querySelector(".btnHomeItemNotFound")),Promise.reject(errorResponse)})})}function getItemWithMediaSource(instance,apiClient){return function(instance,apiClient){var options,fields;return(instance=instance.params).seriesTimerId?apiClient.getLiveTvSeriesTimer(instance.seriesTimerId):instance.timerId?apiClient.getLiveTvTimer(instance.timerId):(options={},fields=[],"true"===instance.asSeries?options.AsSeries=!0:fields.push("ShareLevel"),fields.push("SyncStatus"),fields.push("ContainerSyncStatus"),fields.length&&(options.fields=fields.join(",")),options.ExcludeFields="VideoChapters,VideoMediaSources,MediaStreams",apiClient.getItem(apiClient.getCurrentUserId(),instance.id,options))}(instance,apiClient).then(function(item){var playbackMediaSourcesPromise=isRenderingTrackSelections(item)?_playbackmanager.default.getPlaybackMediaSources(item):Promise.resolve([]);return playbackMediaSourcesPromise.then(function(mediaSources){return{item:item,mediaSources:mediaSources}})})}function startDataLoad(instance){var params=instance.params,apiClient=_connectionmanager.default.getApiClient(params.serverId),params=Promise.all([getItemWithMediaSource(instance,apiClient),apiClient.getCurrentUser()]).then(onDataFetched.bind(instance),function(err){return console.log("error loading item: "+err),onItemFetchError(instance,err,apiClient)});instance.dataPromise=params}function playCurrentItem(instance,mode){(_layoutmanager.default.tv?Promise.resolve(null):Emby.importModule("./modules/multiselect/multiselect.js")).then(function(MultiSelect){var startPositionTicks,view;null!=MultiSelect&&MultiSelect.canPlay()?"shuffle"===mode?MultiSelect.shuffle():MultiSelect.play():(MultiSelect=instance.currentItem,view=instance.view,startPositionTicks=(MultiSelect=MultiSelect).UserData&&"resume"===mode?null:0,view=function(view,params,startPositionTicks){var audioStreamIndex=view.querySelector(".selectAudio").value||null;return{startPositionTicks:startPositionTicks,mediaSourceId:view.querySelector(".selectSource").value,audioStreamIndex:audioStreamIndex,subtitleStreamIndex:view.querySelector(".selectSubtitles").value,parentId:params.parentId}}(view,instance.params,startPositionTicks),"shuffle"===mode&&(view.shuffle=!0),view.items=[MultiSelect],_playbackactions.default.play(view))})}function onPlayClick(e){playCurrentItem(this,e.currentTarget.getAttribute("data-mode"))}function onEdited(){reloadItem(this,!0)}function onEditCancel(){}function onEditMetadataClick(){var currentItem=this.currentItem,instance=this;require(["metadataEditor"]).then(function(responses){return(new responses[0]).show(currentItem.Id,currentItem.ServerId).then(onEdited.bind(instance),onEditCancel)})}function onEditImagesClick(){var currentItem=this.currentItem,instance=this;require(["imageEditor"],function(imageEditor){imageEditor.show({itemId:currentItem.Id,serverId:currentItem.ServerId}).then(onEdited.bind(instance),onEditCancel)})}function onDeleteClick(){var currentItem=this.currentItem;_itemmanager.default.deleteItems({items:[currentItem],navigate:"back"})}function onDownloadChange(){reloadItem(this,!0)}function splitVersions(instance,page,apiClient,params){var options;options="Are you sure you wish to split the media sources into separate items?",Emby.importModule("./modules/common/dialogs/confirm.js").then(function(confirm){return confirm(options)}).then(function(){_loading.default.show(),apiClient.ungroupVersions(params.id).then(function(){_loading.default.hide(),reloadItem(instance,!0)})})}function onReadMoreClick(e){var options,e=e.currentTarget.closest(".overview-container").querySelector(".overview-text");options={html:e.innerHTML,confirmButton:!1,title:_itemmanager.default.getDisplayName(this.currentItem)||this.currentItem.Name,centerText:!1,item:this.currentItem},Emby.importModule("./modules/common/dialogs/alert.js").then(function(alert){return alert(options)})}function onPromiseRejected(e){console.log("itemContextMenu close: "+e)}function getSortMenuOptions(item){switch(item.Type){case"Playlist":return _itemmanager.default.getSortMenuOptions({apiClient:_connectionmanager.default.getApiClient(item),itemType:"PlaylistItem"});case"BoxSet":return _itemmanager.default.getSortMenuOptions({apiClient:_connectionmanager.default.getApiClient(item),itemType:"BoxSetItem"});default:return[]}}function getSortMenuOption(sortMenuOptions,sortBy){for(var i=0,length=sortMenuOptions.length;i<length;i++){var option=sortMenuOptions[i];if(option.value===sortBy)return option}return null}function sortItem(instance,item,options){var currentValues={sortBy:_usersettings.default.itemSortBy(item.Id),sortOrder:_usersettings.default.itemSortOrder(item.Id)},sortItems=getSortMenuOptions(item);return function(options,currentValues){for(var i=0,length=options.length;i<length;i++){var opt=options[i];if(opt.selected=opt.value===(currentValues.sortBy||"default"),opt.selected){var icon="Descending"===currentValues.sortOrder?"&#xe5DB;":"&#xe5D8;";opt.asideIcon=icon;break}}}(sortItems,currentValues),showActionSheet({items:sortItems,positionTo:options.positionTo,positionY:options.positionY,positionX:options.positionX,positionClientY:options.positionClientY,positionClientX:options.positionClientX,transformOrigin:options.transformOrigin,title:_globalize.default.translate("HeaderSortBy"),offsetTop:2,hasItemAsideIcon:!0,hasItemSelectionState:!0}).then(function(value){var sortOrder;sortOrder||(sortOrder=currentValues.sortOrder,sortOrder=currentValues.sortBy===value?"Ascending"===sortOrder?"Descending":"Ascending":function(sortMenuOptions,sortBy){if(sortBy){sortMenuOptions=getSortMenuOption(sortMenuOptions,sortBy);if(sortMenuOptions&&sortMenuOptions.value===sortBy&&sortMenuOptions.defaultSortOrder)return sortMenuOptions.defaultSortOrder}return"Descending"}(sortItems,value)),_usersettings.default.itemSortBy(item.Id,value),_usersettings.default.itemSortOrder(item.Id,sortOrder)})}function onGroupByClick(e){var currentValue,e=e.currentTarget,instance=this;instance.currentItem,e={positionTo:e,positionY:"bottom"},currentValue=_usersettings.default.groupCollectionItems(),showActionSheet({items:[{name:_globalize.default.translate("HeaderMediaType"),value:"mediatype",Selected:currentValue},{name:_globalize.default.translate("None"),value:"",Selected:!currentValue}],positionTo:e.positionTo,positionY:e.positionY,positionX:e.positionX,positionClientY:e.positionClientY,positionClientX:e.positionClientX,transformOrigin:e.transformOrigin,title:_globalize.default.translate("HeaderGroupBy"),offsetTop:2,hasItemSelectionState:!0}).then(function(groupBy){_usersettings.default.groupCollectionItems("mediatype"===groupBy)}).then(function(){reloadItem(instance,!0)})}function getMusicArtistChildrenListOptions(items){return{renderer:_cardbuilder.default,options:{shape:"auto",scalable:!0,centerText:!0,fields:["Name","ProductionYear"],overlayText:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getSeasons(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item),fields=this.getRequestedItemFields()+",PrimaryImageAspectRatio,Overview";return apiClient.getSeasons(item.Id,Object.assign({UserId:apiClient.getCurrentUserId(),Fields:fields},query))}function getPlaylistListOptionsFn(item){return function(items){var fields=[],items=(fields.push("ParentName"),fields.push("Name"),function(items){for(var i=0,length=items.length;i<length;i++){var item=items[i];if(item.Overview){if(item.SupportsResume)return!0;if("Audio"!==item.Type)return!0}}return!1}(items)),enableSideMediaInfo=!0,sortBy=(items&&(fields.push("Overview"),enableSideMediaInfo=!1),_usersettings.default.itemSortBy(item.Id)||"default"),sortOrder=(sortBy="default"===sortBy?"ListItemOrder":sortBy)?_usersettings.default.itemSortOrder(item.Id):null;return{renderer:_listview.default,options:{showIndexNumberLeft:"MusicAlbum"===item.Type,action:"playallfromhere",dragReorder:"Playlist"===item.Type&&!1!==item.CanEditItems&&!_layoutmanager.default.tv&&"ListItemOrder"===sortBy&&"Ascending"===sortOrder,playlistId:"Playlist"===item.Type?item.Id:null,image:"Playlist"===item.Type,artist:"auto",showIndex:"MusicAlbum"===item.Type,autoHideArtist:"MusicAlbum"===item.Type,index:"disc",containerAlbumArtists:"MusicAlbum"===item.Type?item.AlbumArtists:null,fields:fields,playAction:"playallfromhere",enableSideMediaInfo:enableSideMediaInfo,imageSize:items?"medium":null,autoMoveParentName:!0},virtualScrollLayout:"vertical-list",commandOptions:{openAlbum:"MusicAlbum"!==item.Type,gotoItem:!0,removeFromPlaylist:!1!==item.CanEditItems}}}}function scrollEpisodesToSeason(instance,seasonId){var apiClient,seriesId,itemsContainer=instance.view.querySelector(".childrenItemsContainer");itemsContainer&&(instance=instance.currentItem,apiClient=_connectionmanager.default.getApiClient(instance),seriesId=instance.Id,apiClient.getEpisodes(seriesId,{SeasonId:seasonId,UserId:apiClient.getCurrentUserId(),EnableImages:!1,EnableUserData:!1,Limit:1,TotalRecordCount:!1}).then(function(result){var startItem=result.Items[0];startItem&&(-1!==(result=itemsContainer.indexOfItemId(startItem.Id))?itemsContainer.scrollToIndex(result,{offset:"-padding-inline-start"},!1):apiClient.getEpisodes(seriesId,{UserId:apiClient.getCurrentUserId(),EnableTotalRecordCount:!1,EnableImages:!1,EnableUserData:!1}).then(function(totalResult){for(var i=0,length=totalResult.Items.length;i<length;i++)if(totalResult.Items[i].Id===startItem.Id){itemsContainer.scrollToIndex(i,{offset:"-padding-inline-start"},!1);break}}))}))}function onSeriesEpisodeFocusedOrScrolled(instance,item){var detailSelectSeason,item=function(instance,item){if(instance=instance.seasonItems||[],item.SeasonId&&0!==item.ParentIndexNumber){var season=instance.filter(function(s){return s.Id===item.SeasonId})[0];if(season)return season}var seasonNumber=null==item.SortParentIndexNumber?item.ParentIndexNumber:item.SortParentIndexNumber;if(null!=seasonNumber){season=instance.filter(function(s){return s.IndexNumber===seasonNumber})[0];if(season)return season}if(item.SeasonId){season=instance.filter(function(s){return s.Id===item.SeasonId})[0];if(season)return season}return null}(instance,item);item&&((detailSelectSeason=instance.detailSelectSeason)&&detailSelectSeason.setValues([item.Id],!1,[item]),detailSelectSeason=instance.seasonTabs)&&(instance=detailSelectSeason.querySelector('.detailSeasonTab[data-id="'+item.Id+'"]'))&&detailSelectSeason.selectedIndex(parseInt(instance.getAttribute("data-index")),!1)}function getAppearsOnListsListOptions(items){return{renderer:_cardbuilder.default,options:{shape:"autooverflow",centerText:!0,fields:["Name"],overlayText:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getArtistSongsListOptions(items){return _layoutmanager.default.tv?{renderer:_cardbuilder.default,options:{shape:"auto",lines:2,centerText:!1,fields:["Name","Album"],overlayPlayButton:!0,overlayText:!1,sideFooter:!0,action:"play"},virtualScrollLayout:"horizontal-grid",commandOptions:{openArtist:!1}}:{renderer:_listview.default,options:{action:"playallfromhere",overlayPlayButton:!1,verticalWrap:!0,mediaInfo:!1,enableSideMediaInfo:!1,enableUserDataButtons:!1,fields:["Name","ParentName"]},virtualScrollLayout:"horizontal-grid"}}function getPeopleListOptions(items){return{renderer:_cardbuilder.default,options:{cardLayout:!1,centerText:!0,fields:["Name","PersonRole"],cardFooterAside:!1,showPersonRoleOrType:!0,multiSelect:!1,coverImage:!0,shape:"portrait",draggable:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getMoreLikeThisOnLiveTVListOptions(items){return{renderer:_cardbuilder.default,options:{shape:"auto",fields:["ParentName","Name","ProductionYear"],centerText:!0,showDetailsMenu:!0,overlayPlayButton:!0,overlayText:!1,lines:2,draggable:!1,multiSelect:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getNextUpItems(query){var item=this.currentItem,apiClient=_connectionmanager.default.getApiClient(item);return"MusicAlbum"===item.Type?apiClient.getNextUpAudioBookItems(Object.assign({AlbumId:item.Id,Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio",ImageTypeLimit:1,UserId:apiClient.getCurrentUserId()},query)):apiClient.getNextUpEpisodes(Object.assign({SeriesId:item.Id,Fields:this.getRequestedItemFields()+",PrimaryImageAspectRatio",ImageTypeLimit:1,UserId:apiClient.getCurrentUserId()},query))}function getAdditionalPartsListOptions(items){return{renderer:_cardbuilder.default,options:{shape:"autooverflow",scalable:!0,fields:["Name","Runtime"],action:"playallfromhere",centerText:!0,overlayText:!1,draggable:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getExtrasListOptions(items){return{renderer:_cardbuilder.default,options:{shape:"autooverflow",scalable:!0,fields:["Name","Runtime"],centerText:!0,overlayText:!1,draggable:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getSeriesTimerListOptions(items){return{renderer:_listview.default,options:{enableUserDataButtons:!1,image:!0,mediaInfo:!1,imageSize:"large",moreButton:!1,recordButton:!1,draggable:!1,multiSelect:!1,fields:["ParentName","Name","StartToEndDateTime","ChannelName","Overview"],highlight:!1},virtualScrollLayout:"vertical-grid"}}function enableDetailPoster(instance,item){return"true"===instance.params.asDialog||!enableTvDetailImageLayout(instance,item)||_usersettings.default.showDetailPoster(_layoutmanager.default.tv)}function enableTvDetailImageLayout(instance,item){if("true"!==instance.params.asDialog){switch(item.Type){case"Series":case"Season":case"Audio":case"Program":return!0;case"BoxSet":case"TvChannel":case"Playlist":case"MusicAlbum":case"MusicArtist":case"MusicGenre":return!1}switch(item.MediaType){case"Video":case"Photo":case"Game":case"Book":return!0}}return!1}function afterDetailImageRefreshed(){var detailImageElement=this.querySelector(".detailImage");detailImageElement&&(this.querySelector(".cardImageIcon")?detailImageElement.classList.remove("detailImage-transparent"):detailImageElement.classList.add("detailImage-transparent"))}function getChaptersCardOptions(items){return{renderer:_cardbuilder.default,options:{shape:"autooverflow",centerText:!0,overlayText:!1,fields:["Name","ChapterTime"],multiSelect:!1,contextMenu:!1,action:"play",draggable:!1,background:"black",focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getChaptersListViewOptions(items){return{renderer:_listview.default,options:{action:"play",multiSelect:!1,contextMenu:!1,imagePlayButton:!_layoutmanager.default.tv,mediaInfo:!1,enableSideMediaInfo:!1,enableUserDataButtons:!1,fields:["Name","ChapterTime"]}}}function getMoreFromSeasonListOptions(items){return{renderer:_cardbuilder.default,options:{shape:"auto",scalable:!0,fields:["Name"],overlayText:!1,centerText:!0,includeParentInfoInTitle:!1,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function getMoreFromArtistListOptions(items){return{renderer:_cardbuilder.default,options:{shape:"auto",scalable:!0,fields:["Name","ProductionYear"],centerText:!0,overlayText:!1,overlayPlayButton:!0,focusTransformTitleAdjust:!0},virtualScrollLayout:"horizontal-grid"}}function onPromiseFailure(){}function reloadItem(instance,reloadAllData,restartDataLoad){!reloadAllData||instance.dataPromise&&!1===restartDataLoad||startDataLoad(instance),instance.dataPromise.then(function(responses){var trackList,item=responses[0],responses=responses[1],apiClient=_connectionmanager.default.getApiClient(item.ServerId),view=instance.view;!function(view,refreshData){for(var containers=view.querySelectorAll(".generalItemsContainer"),i=0,length=containers.length;i<length;i++)containers[i].resume({refresh:refreshData})}(view,reloadAllData),instance._linkedItemsView&&instance._linkedItemsView.resume({refresh:reloadAllData,item:item}),"Season"===item.Type&&(trackList=view.querySelector(".trackList"))&&trackList.resume({refresh:reloadAllData}).then(function(){!function(element){var items=element.getItems(),focusItem=items.filter(function(i){return!i.UserData||!i.UserData.Played})[0];if(focusItem=focusItem||items[0]){items=element.indexOfItemId(focusItem.Id);if(-1!==items)return element.scrollToIndex(items,{},!0),1}}(trackList)&&_focusmanager.default.autoFocus(view,{skipIfNotEnabled:!0})}),reloadAllData&&(function(view,item,user,apiClient){"SeriesTimer"===item.Type&&(user.Policy.EnableLiveTvManagement?(require(["seriesRecordingEditor"],function(seriesRecordingEditor){seriesRecordingEditor.embed(item,apiClient.serverId(),{context:view.querySelector(".recordingEditor")})}),view.querySelector(".seriesTimerScheduleSection").classList.remove("hide"),view.querySelector(".btnCancelSeriesTimer").classList.remove("hide")):(view.querySelector(".seriesTimerScheduleSection").classList.add("hide"),view.querySelector(".btnCancelSeriesTimer").classList.add("hide")))}(view,item,responses,apiClient),function(instance,view,item,user,apiClient){("Timer"===item.Type||"Recording"===item.Type&&item.TimerId&&"InProgress"===item.Status)&&user.Policy.EnableLiveTvManagement?(hideAll(view,"btnCancelTimer",!0),require(["recordingEditor"],function(RecordingEditor){RecordingEditor=new RecordingEditor;(instance.recordingEditor=RecordingEditor).embed(item,apiClient.serverId(),{context:view.querySelector(".recordingEditor")})})):hideAll(view,"btnCancelTimer")}(instance,view,item,responses,apiClient),view.querySelector(".audioVideoMediaInfo").classList.remove("mediainfo-forcehide"),view.querySelector(".details-additionalContent").classList.remove("hide"),focusMainSection.call(instance.mainSection)),"true"!==instance.params.asDialog&&function(instance,eventName,item){instance.itemShowDispatched||(instance.itemShowDispatched=!0,instance.view.dispatchEvent(new CustomEvent(eventName,{detail:{item:item},bubbles:!0,cancelable:!1})))}(instance,"itemshow",item),_loading.default.hide()},onPromiseFailure)}function addClass(elems,className){for(var i=0,length=elems.length;i<length;i++)elems[i].classList.add(className)}function setScopedFocus(view,query,enabled,type){view="string"==typeof query?view.querySelector(query):query;enabled?(view.classList.add("focusable"),view.setAttribute("data-focusabletype",type||"autofocus")):(view.classList.remove("focusable"),view.removeAttribute("data-focusabletype"))}function updateTrackSelectionsFocusState(instance,view){var instance=instance.trackSelectionsContainer,isFocusable=(instance.querySelector(".selectContainer:not(.hide)")?instance.classList.remove("hide"):instance.classList.add("hide"),instance.querySelector(".selectContainer:not(.hide) select:not([disabled])"));setScopedFocus(view,instance,isFocusable)}var drawerElement=document.querySelector(".mainDrawer");function onNavDrawerStateChange(e,drawerState){"true"!==this.params.asDialog&&(2<=drawerState&&_backdrop.default.hasBackdrop()?drawerElement.classList.add("darkContentContainer"):drawerElement.classList.remove("darkContentContainer"))}function ItemPage(view,params){_baseview.default.apply(this,arguments),this.params=params,this.playerChangeFn=function(){var view=this.view,item=this.currentItem;view&&item&&renderTrackSelectionsWithoutUser(view,this,item)}.bind(this),this.playbackStopFn=function(e,stopInfo){var state=stopInfo.state||{};state.NextMediaType||state.IsBackgroundPlayback||null!=(stopInfo=stopInfo.player)&&stopInfo.isLocalPlayer&&!_usersettings.default.enableVideoUnderUI()&&(stopInfo=state.NowPlayingItem||{},(this.currentItem||{}).MediaType===stopInfo.MediaType)&&stopInfo.MediaType&&"Episode"===stopInfo.Type&&(this.showItemOnResume=stopInfo)}.bind(this),this.onNavDrawerStateChangeFn=onNavDrawerStateChange.bind(this),this.topDetailsContainer=view.querySelector(".topDetailsContainer"),this.mainSection=view.querySelector(".detailMainContainer"),this.trackSelectionsContainer=view.querySelector(".trackSelections"),_layoutmanager.default.tv?addClass(view.querySelectorAll(".reduce-font-size-tv"),"reduce-font-size"):(addClass(view.querySelectorAll(".detailTextContainer"),"details-largefont"),addClass(view.querySelectorAll(".reduce-font-size-tv"),"reduce-font-size-mobile")),this.trackSelectionsContainer.addEventListener("submit",onTrackSelectionsSubmit),bindAll(view,".btnPlay","click",onPlayClick.bind(this)),bindAll(view,".btnResume","click",onPlayClick.bind(this)),bindAll(view,".btnShuffle","click",function(){playCurrentItem(this,"shuffle")}.bind(this)),bindAll(view,".btnPlayTrailer","click",function(){var currentItem=this.currentItem;_playbackmanager.default.playTrailers(currentItem)}.bind(this)),bindAll(view,".btnCancelSeriesTimer","click",function(){onDeleteClick.call(this)}.bind(this)),bindAll(view,".btnCancelTimer","click",function(){var instance=this,item=this.currentItem,type=item.Type,serverId=item.ServerId,timerId="Timer"===type?item.Id:item.TimerId;require(["recordingHelper"],function(recordingHelper){recordingHelper.cancelTimer(_connectionmanager.default.getApiClient(serverId),timerId,!0).then(function(){reloadItem(instance,!0)})})}.bind(this)),bindAll(view,".btnDeleteItem","click",onDeleteClick.bind(this)),bindAll(view,".btnSyncDownload","download",onDownloadChange.bind(this)),bindAll(view,".btnSyncDownload","download-cancel",onDownloadChange.bind(this)),bindAll(view,".btnMoreCommands","click",function(e){var button=e.currentTarget,instance=this,e=this.params,e=_connectionmanager.default.getApiClient(e.serverId),currentItem=this.currentItem;currentItem.MediaSources=instance._currentPlaybackMediaSources,e.getCurrentUser().then(function(user){_itemcontextmenu.default.show(getCommandOptions(instance,currentItem,user,button)).then(function(result){"addtoplaylist"!==result.command&&"addtocollection"!==result.command||reloadItem(instance,!0)},onPromiseRejected)})}.bind(this)),bindAll(view,".btnSortItems","click",function(e){var e=e.currentTarget,instance=this;sortItem(0,instance.currentItem,{positionTo:e,positionY:"bottom"}).then(function(){reloadItem(instance,!0)})}.bind(this)),bindAll(view,".btnGroupBy","click",onGroupByClick.bind(this)),bindAll(view,".btnManageSeriesRecording","click",function(e){var item=this.currentItem;item.SeriesTimerId&&_approuter.default.showItem({Type:"SeriesTimer",Id:item.SeriesTimerId,ServerId:item.ServerId})}.bind(this)),bindAll(view,".btnManageRecording","click",function(e){var item=this.currentItem;item.TimerId&&_approuter.default.showItem({Type:"Timer",Id:item.TimerId,ServerId:item.ServerId})}.bind(this)),this.mainSection.addEventListener("focus",function(e){_layoutmanager.default.tv&&!e.target.closest(".btnReadMore,.recordingEditor,.btnOverviewText")&&this.view.scrollToBeginning()}.bind(this),!0),bindAll(view,".btnSplitVersions","click",function(){var params=this.params,apiClient=_connectionmanager.default.getApiClient(params.serverId);splitVersions(this,this.view,apiClient,params)}.bind(this)),bindAll(view,".btnReadMore","click",onReadMoreClick.bind(this)),bindAll(view,".btnOverviewText","click",onReadMoreClick.bind(this));var instance=this,onLibraryChangedFn=(view.querySelector(".selectSource").addEventListener("change",function(){renderMediaInfo(0,view,instance.currentItem,instance._currentPlaybackMediaSources,_connectionmanager.default.getApiClient(instance.currentItem)),renderVideoSelections(view,instance._currentPlaybackMediaSources),renderAudioSelections(view,instance._currentPlaybackMediaSources),renderSubtitleSelections(view,instance._currentPlaybackMediaSources),updateTrackSelectionsFocusState(instance,view),refreshChapters(view)}),view.querySelector(".btnManualRecording").addEventListener("click",function(e){executeCommandWithCommandProcessor("record",this.currentItem,{positionTo:e.target})}.bind(this)),view.addEventListener("viewbeforehide",function(e){"true"===this.params.asDialog||null!=(e=e.detail)&&null!=(e=e.newViewInfo)&&e.view.classList.contains("itemView")||(backgroundContainer.classList.remove("itemBackgroundContainer","itemBackgroundContainer-transparent","itemBackgroundContainer-preventbackdrop"),backdropContainer.classList.remove("backdropContainer-preventbackdrop"),skinHeader.classList.remove("detailHeader-noIcons"))}.bind(this)),this.onUserDataChangedFn=function(e,apiClient,userData){var currentItem=this.currentItem,view=this.view;currentItem&&currentItem.Id===userData.ItemId&&(currentItem.UserData=userData,this.paused||reloadPlayButtons(this,view,currentItem,!0))}.bind(this),this.onLibraryChangedFn=function(e,apiClient,data){var currentItem=this.currentItem;currentItem&&null!=(data=data.ItemsUpdated)&&data.includes(currentItem.Id)&&(this.paused?this._fullReloadOnResume=!0:reloadItem(this,!0))}.bind(this),this.onTimerCancelledFn=function(e,apiClient,data){var currentItem=this.currentItem;currentItem&&currentItem.Id===data.Id&&!this.paused&&_approuter.default.back()}.bind(this),_events.default.on(_navdrawer.default,"drawer-state-change",this.onNavDrawerStateChangeFn),this.onLibraryChangedFn),onLibraryChangedFn=(onLibraryChangedFn&&_events.default.on(_api.default,"LibraryChanged",onLibraryChangedFn),this.onUserDataChangedFn),onLibraryChangedFn=(onLibraryChangedFn&&_events.default.on(_api.default,"UserDataChanged",onLibraryChangedFn),this.onTimerCancelledFn);onLibraryChangedFn&&_events.default.on(_api.default,"TimerCancelled",onLibraryChangedFn),"true"===params.asDialog&&(view.querySelector(".padded-top-page").classList.add("padded-top-page-item-dialog"),onLibraryChangedFn=_layoutmanager.default.tv?"":' data-blur="true"',view.querySelector(".scrollSlider").insertAdjacentHTML("afterbegin",'<button type="button"'+onLibraryChangedFn+' is="emby-dialogclosebutton" class="dialogCloseButton-positionstart" style="top:1em;z-index:1;"></button>'))}Object.assign(ItemPage.prototype,_baseview.default.prototype),ItemPage.prototype.onInputCommand=function(e){var command=e.detail.command;switch(command){case"play":return playCurrentItem(this,"resume"),e.preventDefault(),void e.stopPropagation();case"delete":return onDeleteClick.call(this),e.preventDefault(),void e.stopPropagation();case"record":return executeCommandWithCommandProcessor(command,this.currentItem,{positionTo:e.target}),e.preventDefault(),void e.stopPropagation()}_baseview.default.prototype.onInputCommand.apply(this,arguments)},ItemPage.prototype.onBeginResume=function(options){_baseview.default.prototype.onBeginResume.apply(this,arguments),"true"!==this.params.asDialog&&(_layoutmanager.default.tv?skinHeader.classList.add("detailHeader-noIcons"):skinHeader.classList.remove("detailHeader-noIcons")),startDataLoad(this)},ItemPage.prototype.onResume=function(options){this.showItemOnResume&&(newItem=this.showItemOnResume,_approuter.default.replaceState(_approuter.default.getRouteUrl(newItem,{}),!0),this.showItemOnResume=null),_baseview.default.prototype.onResume.apply(this,arguments),this.itemShowDispatched=null;var newItem=this.view,onPlayerChangeFn=this.playerChangeFn,onPlayerChangeFn=(onPlayerChangeFn&&_events.default.on(_playbackmanager.default,"playerchange",onPlayerChangeFn),this.playbackStopFn),onPlayerChangeFn=(onPlayerChangeFn&&_events.default.on(_playbackmanager.default,"playbackstop",onPlayerChangeFn),options.refresh||this._fullReloadOnResume);this._fullReloadOnResume=!1,reloadItem(this,onPlayerChangeFn,!1),onPlayerChangeFn||(renderTrackSelectionsWithoutUser(newItem,this,onPlayerChangeFn=this.currentItem,!0),setTrailerButtonVisibility(newItem,onPlayerChangeFn)),this._fullReloadOnResume=!1,this.updateDrawerState()},ItemPage.prototype.updateDrawerState=function(){onNavDrawerStateChange.call(this,{},_navdrawer.default.drawerState)},ItemPage.prototype.onPause=function(options){_baseview.default.prototype.onPause.apply(this,arguments);for(var onPlayerChangeFn=this.playerChangeFn,onPlayerChangeFn=(onPlayerChangeFn&&_events.default.off(_playbackmanager.default,"playerchange",onPlayerChangeFn),this.playbackStopFn),onPlayerChangeFn=(onPlayerChangeFn&&_events.default.off(_playbackmanager.default,"playbackstopped",onPlayerChangeFn),this.onNavDrawerStateChangeFn&&_events.default.off(_navdrawer.default,"drawer-state-change",this.onNavDrawerStateChangeFn),this.view),containers=onPlayerChangeFn.querySelectorAll(".generalItemsContainer"),i=0,length=containers.length;i<length;i++)containers[i].pause();onPlayerChangeFn.querySelector(".chaptersItemsContainer").pause(),"true"===this.params.asDialog||null!=(onPlayerChangeFn=options.newViewInfo)&&onPlayerChangeFn.view.classList.contains("itemView")||drawerElement.classList.remove("darkContentContainer"),this._linkedItemsView&&this._linkedItemsView.pause(),this.recordingEditor&&this.recordingEditor.pause()},ItemPage.prototype.enableTransitions=function(){return!0},ItemPage.prototype.destroy=function(){var onLibraryChangedFn=this.onLibraryChangedFn,onLibraryChangedFn=(onLibraryChangedFn&&_events.default.off(_api.default,"LibraryChanged",onLibraryChangedFn),this.onLibraryChangedFn=null,this.onUserDataChangedFn),onLibraryChangedFn=(onLibraryChangedFn&&_events.default.off(_api.default,"UserDataChanged",onLibraryChangedFn),this.onUserDataChangedFn=null,this.onTimerCancelledFn);onLibraryChangedFn&&_events.default.off(_api.default,"TimerCancelled",onLibraryChangedFn),this.onTimerCancelledFn=null,_baseview.default.prototype.destroy.apply(this,arguments),this.onNavDrawerStateChangeFn=null,this.playerChangeFn=null,this.playbackStopFn=null,this.currentItem=null,this._currentPlaybackMediaSources=null,this.currentRecordingFields&&(this.currentRecordingFields.destroy(),this.currentRecordingFields=null),this.recordingEditor&&(this.recordingEditor.destroy(),this.recordingEditor=null),this._linkedItemsView&&(this._linkedItemsView.destroy(),this._linkedItemsView=null),this.topDetailsContainer=null,this.mainSection=null,this.trackSelectionsContainer=null,this.detailSelectSeason=null,this.seasonTabs=null,this.seasonItems=null,this.params=null,this.dataPromise=null};_exports.default=ItemPage});