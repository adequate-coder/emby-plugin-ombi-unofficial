define(["exports","./../dom.js","./../layoutmanager.js","./../appheader/appheadercontent.js"],function(_exports,_dom,_layoutmanager,_appheadercontent){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;function Headroom(options){options=options||{},this.lastScrollY=0,this.lastTransformScrollY=0,this.element=options.element,this.scrollElementForEvents=options.scroller||window,this.scroller=this.scrollElementForEvents,this.offset=options.offset,this.enableScrollingStatus=options.enableScrollingStatus,this.paused=!0}require(["css!modules/headroom/headroom.css"]);var isNativeAndroid="android"===globalThis.appMode;var currentInstance,headerElement=document.querySelector(".skinHeader"),headerElement=(_dom.default.addEventListener(headerElement,"focus",function(){var scroller;currentInstance&&currentInstance.hideWithAnyScroll&&(scroller=currentInstance.scrollElementForEvents)&&scroller.scrollToBeginning()},{passive:!0,capture:!0}),function(){if(isNativeAndroid)return!0;try{var val=getComputedStyle(document.documentElement).getPropertyValue("--env-inset-top");if(val&&!val.includes("env("))return!0}catch(err){}return!1}());try{document.documentElement.style.setProperty("--env-inset-top","1")}catch(err){}var SupportsTranslateProperty=CSS.supports("translate","40px 100px"),TranslateProperty=SupportsTranslateProperty?"translate":CSS.supports("transform","scale(1)")?"transform":"-webkit-transform";function buildTranslateValue(value){return SupportsTranslateProperty?"0 "+value:"translateY("+value+")"}var topCalcNative=buildTranslateValue("calc(-100% + env(safe-area-inset-top, 0))"),topCalc=headerElement?isNativeAndroid?buildTranslateValue("calc(-100% + var(--window-inset-top, 0))"):topCalcNative:buildTranslateValue("-100%");var DefaultScrollThreshold=Math.max(10*(window.devicePixelRatio||1),20);Headroom.prototype={constructor:Headroom,init:function(){return this.isScrolling=!1,this.attachEvent(),_layoutmanager.default.tv&&(this.hideWithAnyScroll=!0),this.hideWithAnyScroll&&(this.enableScrollingStatus=!1),this},pause:function(){this.paused=!0,currentInstance===this&&(currentInstance=null);var elem=this.element;elem&&(this.isScrolling&&elem.classList.remove("headroom-scrolling"),this.isHidden)&&elem.classList.remove("headroom-hidden")},clearTransform:function(){var elem=this.element;elem&&(this.isScrolling&&elem.classList.remove("headroom-scrolling"),this.isHidden)&&elem.classList.remove("headroom-hidden"),this.setTransform(0,this.lastTransformScrollY,!0,!0,!0)},beginResume:function(){this.paused&&this.allowBeginResume&&(this.paused=!1,(currentInstance=this).updateFn(null,!0,!0,!0))},resume:function(){this.paused&&(this.paused=!1,(currentInstance=this).updateFn(null,!0,!0,!1))},destroy:function(){this.lastScrollY=null,this.lastTransformScrollY=null;var scroller=this.scrollElementForEvents;scroller&&(scroller.removeScrollEventListener?scroller.removeScrollEventListener(this.updateFn,{capture:!1,passive:!0}):_dom.default.removeEventListener(scroller,"scroll",this.updateFn,{capture:!1,passive:!0})),this.scrollElementForEvents=null,this.scroller=null,this.element=null},attachEvent:function(){var isNativeScroll=this.scroller.isNativeScroll(),isNativeScroll=(this.isNativeScroll=isNativeScroll,this.updateFn=(isNativeScroll?this.updateWithRequestAnimationFrame:this.update).bind(this),this.lastScrollY=this.scroller.getScrollPosition(),this.allowBeginResume=!isNativeScroll,this.lastTransformScrollY=this.lastScrollY,this.scrollElementForEvents);isNativeScroll&&(isNativeScroll.addScrollEventListener?isNativeScroll.addScrollEventListener(this.updateFn,{capture:!1,passive:!0}):_dom.default.addEventListener(isNativeScroll,"scroll",this.updateFn,{capture:!1,passive:!0}))},setTransform:function(value,currentScrollY,top,forceRefresh,immediate){var isHidden,elem=this.element;elem&&(this.lastTransformScrollY=currentScrollY,forceRefresh||value!==this.transform)&&(currentScrollY=value!==elem.headroomTransform,this.transform=value,top=!top,0===(elem.headroomTransform=value)?value="none":1===value?(value=topCalc,isHidden=!0):value=buildTranslateValue("-"+value+"px"),this.enableScrollingStatus&&(this.isScrolling===top&&!forceRefresh||((this.isScrolling=top)?elem.classList.add("headroom-scrolling"):elem.classList.remove("headroom-scrolling")),this.isHidden===isHidden&&!forceRefresh||((this.isHidden=isHidden)?elem.classList.add("headroom-hidden"):elem.classList.remove("headroom-hidden"))),currentScrollY||forceRefresh)&&(immediate?function(elem,classList,value){classList.add("headroom-notransition"),elem.style[TranslateProperty]=value,elem.offsetWidth,classList.remove("headroom-notransition")}(elem,elem.classList,value):!this.isNativeScroll&&immediate||(elem.style[TranslateProperty]=value))},setTransformWithAnimationFrame:function(elem,value){requestAnimationFrame(function(){elem.style[TranslateProperty]=value})},update:function(e,forceRefresh,immediate,enableBackgroundSupport){var currentScrollY,hideWithAnyScroll,top,lastTransformScrollY,scrollThreshold;this.paused||(enableBackgroundSupport&&this.isNativeScroll?null==(currentScrollY=this.scroller.getLastScrollPosition())&&(currentScrollY=this.lastScrollY||0):currentScrollY=this.scroller.getScrollPosition(),enableBackgroundSupport=this.lastScrollY,hideWithAnyScroll=this.hideWithAnyScroll,enableBackgroundSupport=enableBackgroundSupport<currentScrollY?1:currentScrollY<enableBackgroundSupport?-1:0,(forceRefresh=!0===forceRefresh)&&(enableBackgroundSupport=0),lastTransformScrollY=this.lastTransformScrollY,scrollThreshold=DefaultScrollThreshold,top=currentScrollY<=(hideWithAnyScroll?_appheadercontent.default.getHeight():0),lastTransformScrollY=forceRefresh||Math.abs(currentScrollY-lastTransformScrollY)>scrollThreshold,!top&&1===enableBackgroundSupport&&lastTransformScrollY?this.setTransform(1,currentScrollY,top,forceRefresh,immediate):-1===enableBackgroundSupport&&!hideWithAnyScroll&&lastTransformScrollY||top?this.setTransform(0,currentScrollY,top,forceRefresh||top,immediate):!enableBackgroundSupport&&forceRefresh&&(scrollThreshold=this.transform,this.setTransform(top?0:null==scrollThreshold?1:scrollThreshold,currentScrollY,top,forceRefresh||top,immediate)),this.lastScrollY=currentScrollY)},updateWithRequestAnimationFrame:function(e,forceRefresh,immediate,enableBackgroundSupport){var instance=this;requestAnimationFrame(function(){instance.update(e,forceRefresh,immediate,enableBackgroundSupport)})}},_exports.default=Headroom});