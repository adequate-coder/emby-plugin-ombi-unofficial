define(["exports","./../emby-apiclient/connectionmanager.js","./../emby-elements/emby-button/emby-button.js","./../emby-elements/emby-scroller/emby-scroller.js","./../emby-elements/emby-toggle/emby-toggle.js","./../emby-elements/emby-itemscontainer/emby-itemscontainer.js","./../dialoghelper/dialoghelper.js","./../layoutmanager.js","./../dom.js","./../common/globalize.js","./../loading/loading.js","./../focusmanager.js","./../listview/listview.js","./../emby-elements/emby-dialogclosebutton/emby-dialogclosebutton.js"],function(_exports,_connectionmanager,_embyButton,_embyScroller,_embyToggle,_embyItemscontainer,_dialoghelper,_layoutmanager,_dom,_globalize,_loading,_focusmanager,_listview,_embyDialogclosebutton){function MissingEpisodesDialog(){}function onAllItemsContainerUpgraded(){this.itemsContainer.resume({refresh:!0}).then(function(){var dlg=this.dlg;_focusmanager.default.autoFocus(dlg,{skipIfNotEnabled:!0})}.bind(this))}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,require(["material-icons","formDialogStyle"]),MissingEpisodesDialog.prototype.getItems=function(query){var options=this.options,apiClient=_connectionmanager.default.getApiClient(options.items[0]);return apiClient.getMissingEpisodes(Object.assign({UserId:apiClient.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb",Fields:"Overview",ParentId:options.items[0].Id,IncludeSpecials:this.dlg.querySelector(".chkSpecials").checked,IncludeUnaired:this.dlg.querySelector(".chkUnaired").checked},query))},MissingEpisodesDialog.prototype.getListOptions=function(items){return{renderer:_listview.default,options:{enableDefaultIcon:!0,action:"overview",fields:["Name","MediaInfo","Overview"],draggable:!1,draggableXActions:!1,multiSelect:!1,contextMenu:!1,hoverPlayButton:!1,imageSize:"medium",enableUserDataButtons:!1,mediaInfo:!1,enableBottomOverview:!1},virtualScrollLayout:"vertical-list"}},MissingEpisodesDialog.prototype.show=function(options){var dialogOptions={removeOnClose:!0,scrollY:!1,autoFocus:!1},dialogOptions=(_layoutmanager.default.tv?dialogOptions.size="fullscreen":dialogOptions.size="small",_dialoghelper.default.createDialog(dialogOptions)),html=(dialogOptions.classList.add("formDialog"),""),itemsContainer=(html=(html=(html=(html=(html+='<div class="formDialogHeader">')+'<button type="button" is="emby-dialogclosebutton" closetype="done"></button>'+'<h3 class="formDialogHeaderTitle">')+_globalize.default.translate("HeaderMissingEpisodes"))+"</h3>"+"</div>")+function(options){var html="",scrollerStyle="width:100%;",html=(_layoutmanager.default.tv&&(scrollerStyle+="max-width:90ch;"),(html+='<div class="formDialogContent flex flex-direction-column align-items-center" style="overflow:hidden;">')+'<div is="emby-scroller" data-horizontal="false" data-forcescrollbar="true" data-focusscroll="true" class="flex flex-grow virtualScrollerScrollContainer" style="'+scrollerStyle+'"><div class="scrollSlider dialog-content-centered padded-left padded-right flex-grow">'),scrollerStyle=_connectionmanager.default.getApiClient(options.items[0]).isMinServerVersion("4.8.0.59")?"":" hide";return _layoutmanager.default.tv&&(scrollerStyle+=" padded-top"),html=(html=(html=(html=(html=(html=(html=(html=(html=(html+='<div style="margin-bottom:.5em;" class="flex align-items-center justify-content-flex-end fieldItems'+scrollerStyle+' focuscontainer-x">')+'<div class="toggleContainer fieldItems-item" style="margin-bottom:0;">'+'<label style="width:auto;">')+('<input is="emby-toggle" type="checkbox" class="chkSpecials" label="'+_globalize.default.translate("Specials")+'" />'))+"</label>"+"</div>")+'<div class="toggleContainer fieldItems-item" style="margin-bottom:0;">'+'<label style="width:auto;">')+('<input is="emby-toggle" type="checkbox" class="chkUnaired" label="'+_globalize.default.translate("Upcoming")+'" />'))+"</label>"+"</div>")+"</div>"+'<div is="emby-itemscontainer" data-virtualscrolllayout="vertical-grid" class="itemsContainer allItemsContainer itemsContainer-defaultCardSize vertical-wrap padded-bottom-page">')+"</div>"+"</div>")+"</div>"+"</div>"}(options),dialogOptions.innerHTML=html,this.dlg=dialogOptions,this.options=options,dialogOptions.querySelector(".allItemsContainer")),html=(itemsContainer.fetchData=this.getItems.bind(this),itemsContainer.getListOptions=this.getListOptions.bind(this),itemsContainer.afterRefresh=function(result){result.TotalRecordCount||(this.itemsContainer.innerHTML="<p>"+_globalize.default.translate("NoItemsFound")+"</p>"),_loading.default.hide()}.bind(this),this.itemsContainer=itemsContainer,dialogOptions.querySelector(".fieldItems").addEventListener("change",function(){itemsContainer.refreshItems()}),dialogOptions.addEventListener("opened",function(){_loading.default.show();var itemsContainer=this.itemsContainer;itemsContainer.resume?onAllItemsContainerUpgraded.call(this):_dom.default.addEventListener(itemsContainer,"upgraded",onAllItemsContainerUpgraded.bind(this),{once:!0})}.bind(this)),function(){return this.cleanup(),Promise.resolve()}.bind(this));return _dialoghelper.default.open(dialogOptions).then(html,html)},MissingEpisodesDialog.prototype.closeDialog=function(){var dlg=this.dlg;dlg&&_dialoghelper.default.close(dlg)},MissingEpisodesDialog.prototype.cleanup=function(){this.listName=null,this.options=null,this.dlg=null,this.itemsContainer=null,this.recentItemsContainer=null};_exports.default=MissingEpisodesDialog});