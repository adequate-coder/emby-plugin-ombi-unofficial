define(["exports","./../emby-apiclient/connectionmanager.js","./../dom.js","./../common/globalize.js","./../layoutmanager.js","./../common/itemmanager/itemmanager.js","./../common/imagehelper.js","./../dialoghelper/dialoghelper.js","./../emby-elements/emby-button/emby-button.js","./../emby-elements/emby-scroller/emby-scroller.js","./../emby-elements/emby-itemscontainer/emby-itemscontainer.js","./../approuter.js","./../focusmanager.js","./../listview/listview.js","./../shortcuts.js","./../browser.js","./../common/textencoding.js"],function(_exports,_connectionmanager,_dom,_globalize,_layoutmanager,_itemmanager,_imagehelper,_dialoghelper,_embyButton,_embyScroller,_embyItemscontainer,_approuter,_focusmanager,_listview,_shortcuts,_browser,_textencoding){function onCancelClick(e){_dialoghelper.default.close(this.closest(".actionSheet"))}function getTextLinkButton(item){var href=_approuter.default.getRouteUrl(item);return'<a is="emby-linkbutton" class="button-link noautofocus actionsheetPreviewTextItem mediaInfoItem" data-href="'+href+'" href="'+href+'">'+_textencoding.default.htmlEncode(item.Name)+"</a>"}function autoFocusInternal(dlg,options){var focused=_focusmanager.default.autoFocus(dlg.querySelector(".itemsContainer"),options);focused||null!=options&&options.skipIfNotEnabled&&!_focusmanager.default.isAutoFocusEnabled()||_focusmanager.default.autoFocus(dlg,options)}function onItemsContainerUpgraded(){return this.querySelector(".itemsContainer").resume({refresh:!0})}function refreshItemsContainer(){var itemsContainer=this.querySelector(".itemsContainer");return itemsContainer.resume?onItemsContainerUpgraded.call(this):function(instance,itemsContainer){return new Promise(function(resolve,reject){_dom.default.addEventListener(itemsContainer,"upgraded",function(){onItemsContainerUpgraded.call(instance).then(resolve,reject)},{once:!0})})}(this,itemsContainer)}function getListViewItemFromInputItem(option,options){var isSelected,item={Name:option.Name||option.name||option.textContent||option.innerText,ServerId:option.ServerId||null,MediaType:option.MediaType||null,IsFolder:option.IsFolder,Type:option.Type,Overview:option.Overview,PrimaryImageAspectRatio:option.PrimaryImageAspectRatio,RunTimeTicks:option.RunTimeTicks,IndexNumber:option.IndexNumber,IndexNumberEnd:option.IndexNumberEnd,SupportsResume:option.SupportsResume,ParentIndexNumber:option.ParentIndexNumber,ProductionYear:option.ProductionYear,PremiereDate:option.PremiereDate,SeriesName:option.SeriesName,NameSubtitle:option.nameSubtitle,Artists:option.Artists,ArtistItems:option.ArtistItems,AlbumArtists:option.AlbumArtists,Composers:option.Composers,AlbumArtist:option.AlbumArtist,Album:option.Album,AlbumId:option.AlbumId,SeriesId:option.SeriesId,SeasonId:option.SeasonId,SeasonName:option.SeasonName,ImageTags:option.ImageTags,BackdropImageTags:option.BackdropImageTags,PrimaryImageTag:option.PrimaryImageTag,AlbumPrimaryImageTag:option.AlbumPrimaryImageTag,SeriesPrimaryImageTag:option.SeriesPrimaryImageTag,ParentThumbItemId:option.ParentThumbItemId,ParentThumbImageTag:option.ParentThumbImageTag,ParentLogoItemId:option.ParentLogoItemId,ParentLogoImageTag:option.ParentLogoImageTag,ParentBackdropItemId:option.ParentBackdropItemId,ParentBackdropImageTags:option.ParentBackdropImageTags,ImageUrl:option.ImageUrl,hasDivider:option.dividerAfter,CanReorder:option.CanReorder},selectedValuesIncludesId=(options.nameProperty&&null!=option[options.nameProperty]&&(item.Name=option[options.nameProperty]),options.getItemId?item.Id=options.getItemId(option):null!=option.Id?item.Id=option.Id:null!=option.id&&""!==option.id?item.Id=option.id:null!=option.value?item.Id=option.value:item.Id=option.Name||option.name,null!=item.Id&&options.selectedValuesClone.includes(item.Id));return options.multiple?(isSelected=options.emptyValueSetEqualsAll&&!options.selectedValuesClone.length||selectedValuesIncludesId,item.Selected=isSelected):item.Selected=option.selected||option.Selected||selectedValuesIncludesId,item.Icon=option.icon||option.Icon||(options.useIconForSelection&&item.Selected&&options.hasItemSelectionState?"&#xe5ca;":null),item.iconClass=option.iconClass,item.asideText=option.asideText,item.asideIcon=option.asideIcon||(options.useAsideIconForSelection&&item.Selected&&options.hasItemSelectionState?"&#xe5ca;":null),item.ShortOverview=options.getItemSecondaryText?options.getItemSecondaryText(option):option.secondaryText||option.title||option.ShortOverview,item.originalItem=option,item}function getItemsFn(options){return function(query){if(query=query||{},options.getItems)return function(options,query){return options.getItems(query).then(function(result){for(var items=result.Items.slice(0),i=0,length=items.length;i<length;i++)items[i]=getListViewItemFromInputItem(items[i],options);return result.Items=items,result})}(options,query);for(var inputItems=options.items||[],items=[],i=0,length=inputItems.length;i<length;i++){var item=getListViewItemFromInputItem(inputItems[i],options);items.push(item)}var totalRecordCount=items.length,items=items.slice(query.StartIndex||0);return null!=query.Limit&&items.length>query.Limit&&(items.length=Math.min(items.length,query.Limit)),Promise.resolve({Items:items,TotalRecordCount:totalRecordCount})}}function onItemsChecked(options){for(var items=options.items,checked=options.checked,i=0,length=items.length;i<length;i++)items[i].Selected=checked;return Promise.resolve()}function getListOptions(){return{renderer:_listview.default,options:function(options){var listItemBodyClass,iconClass,asideTextClass,menuItemClass="actionSheetMenuItem",fields=(options.menuItemClass&&(menuItemClass+=" "+options.menuItemClass),options.iconRight&&(menuItemClass+=" actionSheetMenuItem-iconright"),options.multiple?listItemBodyClass="actionsheetListItemBody-multiple":(_layoutmanager.default.tv&&(menuItemClass+=" actionSheetMenuItem-tv"),options.hasItemIcon||options.hasItemSelectionState||(menuItemClass+=" actionSheetMenuItem-noicon"),listItemBodyClass="actionsheetListItemBody",options.iconRight&&(listItemBodyClass+=" actionsheetListItemBody-iconright"),iconClass="actionsheetMenuItemIcon listItemIcon listItemIcon-transparent md-icon",asideTextClass="actionSheetItemAsideText"),(fields=options.fields)||["Name"]),noTextWrap=(options.multiple&&fields.unshift("ItemCheckbox"),options.noTextWrap||options.hasItemAsideText),fields={action:options.multiple?"togglecheckbox":"custom",fields:fields,draggable:options.enableReordering||!1,dragReorder:options.enableReordering||!1,dragHandleClass:"actionsheet-draghandle",draggableXActions:!1,noTextWrap:noTextWrap,multiSelect:!1,contextMenu:!1,hoverPlayButton:!1,itemClass:menuItemClass,contentWrapperClass:options.listItemContentWrapperClass,listItemBodyClassName:listItemBodyClass,iconClass:iconClass,listItemBodyTextClass:"actionSheetItemText",fillEmptyTextlines:!1,enableDefaultIcon:!0===options.enableDefaultIcon,highlight:options.highlight,border:_layoutmanager.default.tv?options.border:!1!==options.border,artist:options.artist,asideTextClass:asideTextClass,asideIconClass:((asideTextClass||"")+" actionSheetItemAsideIcon").trim(),image:!options.multiple&&(!0===options.hasItemIcon||!0===options.hasItemImage||!0===options.hasItemSelectionState),checkboxAction:onItemsChecked,enableUserDataButtons:!1,moreButton:!1,mediaInfo:!1,textLinks:!1,enableSideMediaInfo:!1,overviewLines:options.overviewLines||2,iconSpacing:!options.hasItemImage,imageSize:options.hasItemImage?"smallest":null,roundImage:options.roundImage,allowBorderXOffset:!1,expandOutOnFocus:!0},noTextWrap="actionSheetItemImageContainer";return options.useListViewSizing||(noTextWrap+=" actionSheetItemImageContainer-customsize",!1!==options.useCustomImageContainerWidth&&(noTextWrap+=" actionSheetItemImageContainer-customwidth")),(options.hasItemSelectionState||options.hasItemIcon)&&(noTextWrap+=" actionSheetItemImageContainer-transparent"),fields.imageContainerClass=noTextWrap,fields}(this),virtualScrollLayout:this.useVirtualScroller?"vertical-list":null}}function callUpdateElement(itemsContainer,options){for(var items=itemsContainer.querySelectorAll(itemsContainer.getItemSelector()),i=0,length=items.length;i<length;i++){var elem=items[i];!function(element,item,options){var classList;element&&(classList=element.classList)&&(item&&item.Selected?classList.add("autofocus"):classList.remove("autofocus"),options.borderAll||!options.clearBorder&&!options.hasDivider||(classList=element.querySelector(".listItem-content"))&&(!options.clearBorder&&null!=item&&item.hasDivider?classList.classList.remove("actionsheet-noborder"):classList.classList.add("actionsheet-noborder")))}(elem,itemsContainer.getItemFromElement(elem),options)}}function ActionSheet(){}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,require(["css!modules/actionsheet/actionsheet.css","material-icons"]),ActionSheet.prototype.show=function(options){for(var inputItems=options.items||[],i=0,length=inputItems.length;i<length;i++)if(inputItems[i].dividerAfter){options.hasDivider=!0;break}_layoutmanager.default.tv||(options.highlight=!1,options.clearBorder=!options.hasDivider,!_browser.default.android&&options.hasDivider&&(options.borderAll=!0));var enablePaddingTop,enablePaddingBottom,dialogOptions={removeOnClose:!0,enableHistory:options.enableHistory,autoFocus:!1,refocus:options.refocus,autoCenter:!1,transparentBackground:"auto",positionTo:options.positionTo,positionX:options.positionX,positionY:options.positionY,transformOrigin:options.transformOrigin,minWidthToElement:options.minWidthToElement,positionClientX:options.positionClientX,positionClientY:options.positionClientY,offsetLeft:options.offsetLeft,offsetTop:options.offsetTop,blurBackground:options.blurBackground,setCurrentFocusScope:options.setCurrentFocusScope,swipeClose:options.swipeClose,autoRepositionY:options.autoRepositionY,setDialogSize:!1,size:options.dialogSize,autoLowResLayout:options.autoLowResLayout,lowResXMargin:!0,lowResAutoHeight:!0},useVirtualScroller=null!=options.getItems&&options.enableVirtualScroller,isFullscreen=((options.useVirtualScroller=useVirtualScroller)&&(dialogOptions.fixedSize=!0),"fullscreen"===dialogOptions.size),dlg=(options.hasItemImage&&(options.useListViewSizing=!0),isFullscreen||(enablePaddingInline=enablePaddingBottom=enablePaddingTop=!0),_dialoghelper.default.createDialog(dialogOptions)),instance=this,dialogOptions=((instance.dlg=dlg).classList.add("actionSheet"),_layoutmanager.default.tv),forceAutoFocus=(dialogOptions&&dlg.classList.add("actionSheet-focusscale"),_layoutmanager.default.tv||options.hasItemSelectionState),forceAutoFocus=((forceAutoFocus||isFullscreen)&&(dlg.classList.add("dlg-autofocus"),forceAutoFocus)&&dlg.classList.add("dlg-autofocus-force"),isFullscreen||(useVirtualScroller&&dlg.classList.add("actionSheet-virtualscroll"),_layoutmanager.default.tv||(dlg.classList.add("actionSheet-automobile","actionSheet-largefont"),options.multiple&&dlg.classList.add("actionSheet-smallfont")),!1!==options.blur&&_dom.default.allowBackdropFilter()&&dlg.classList.add("dialog-blur")),options.dialogClass&&dlg.classList.add(options.dialogClass),"");options.hasItemSelectionState?options.hasItemIcon?(options.iconRight=!1,options.useAsideIconForSelection=!0):(options.iconRight=!1,options.useIconForSelection=!0):!options.hasItemIcon||options.hasItemAsideIcon||options.hasItemAsideText||!1===options.iconRight||(options.iconRight=!0),options.iconRight&&!isFullscreen&&(options.useCustomImageContainerWidth=!1),isFullscreen?forceAutoFocus+='<button is="paper-icon-button-light" class="btnCloseActionSheet btnCloseActionSheet-tv hide-mouse-idle-tv" tabindex="-1"><i class="md-icon autortl">&#xe5cd;</i></button>':useVirtualScroller&&(forceAutoFocus+='<button is="paper-icon-button-light" class="btnCloseActionSheet dialogbutton-hidenotfullscreen btnCloseActionSheet-tv hide-mouse-idle-tv" tabindex="-1"><i class="md-icon autortl">&#xe5cd;</i></button>');(!options.title||options.hasItemIcon||options.hasItemImage||options.hasItemSelectionState)&&!isFullscreen||dlg.classList.add("actionsheet-centered");for(var selectNoneText,enablePaddingInline,previewHtml="",previewHtml=(options.item&&(previewHtml=function(options,item){var html="",apiClient=(html+='<div class="actionsheetItemPreview flex flex-direction-row">',_connectionmanager.default.getApiClient(item)),imageUrl=(imageUrlInfo=_imagehelper.default.getImageUrl(item,apiClient,{height:60,width:200})).imgUrl,imgClass="",round="MusicArtist"===item.Type,html=imageUrl?(imageUrlInfo=imageUrlInfo.aspect||1,imgClass=(imgClass+=" actionsheetItemPreviewImage-bg")+" actionsheetItemPreviewImage-bg-"+(shape=_imagehelper.default.getShapeFromAspect(imageUrlInfo)),round&&"square"===shape&&(imgClass+=" actionsheetItemPreviewImage-round"),html+('<div class="'+imgClass.trim())+'" style="aspect-ratio:'+imageUrlInfo+";background-image:url("+imageUrl+');"></div>'):(imgClass+=" actionsheetItemPreviewImage-iconcontainer",round&&(imgClass+=" actionsheetItemPreviewImage-round"),(html=html+('<div class="'+imgClass.trim())+'"><i class="actionsheetItemPreviewImage-icon md-icon autortl">')+_itemmanager.default.getDefaultIcon(item)+"</i></div>"),lines=(html+='<div class="actionsheetItemPreviewContent">',[]),shape=(item.SeriesName?item.SeriesId?lines.push(getTextLinkButton({Type:"Series",Id:item.SeriesId,Name:item.SeriesName,IsFolder:!0,ServerId:item.ServerId})):lines.push(_textencoding.default.htmlEncode(item.SeriesName||"")):"Program"===item.Type&&lines.push(_textencoding.default.htmlEncode(item.Name||"")),_textencoding.default.htmlEncode(_itemmanager.default.getDisplayName(item,{})||"")),imageUrlInfo='<div class="actionsheetPreviewTextItem mediaInfoItem">'+shape+"</div>",round=("Audio"!==item.MediaType||_layoutmanager.default.tv||!1===options.linkToItem||(imageUrlInfo+='<a is="emby-linkbutton" title="'+shape+'" style="font-weight:inherit;" href="'+_approuter.default.getRouteUrl(item)+'" class="flex-shrink-zero actionsheetPreviewTextItem mediaInfoItem button-link button-link-color-inherit"><i class="md-icon" style="font-size:160%;">&#xe88e;</i></a>'),lines.push(imageUrlInfo),"Server"===item.Type&&(apiClient&&apiClient.serverVersion()&&lines.push(apiClient.serverVersion()),apiClient)&&apiClient.serverAddress()&&lines.push(apiClient.serverAddress()),"User"===item.Type&&options.showServerName&&(imageUrl=apiClient.serverName())&&lines.push(_textencoding.default.htmlEncode(imageUrl)),item.IsFolder&&item.AlbumArtists&&item.AlbumArtists.length?lines.push(getTextLinkButton({Type:"MusicArtist",Id:item.AlbumArtists[0].Id,Name:item.AlbumArtists[0].Name,ServerId:item.ServerId})):item.ArtistItems&&item.ArtistItems.length?lines.push(getTextLinkButton({Type:"MusicArtist",Id:item.ArtistItems[0].Id,Name:item.ArtistItems[0].Name,ServerId:item.ServerId})):item.AlbumArtists&&item.AlbumArtists.length&&lines.push(getTextLinkButton({Type:"MusicArtist",Id:item.AlbumArtists[0].Id,Name:item.AlbumArtists[0].Name,ServerId:item.ServerId})),[]);item.Album&&item.AlbumId?round.push(getTextLinkButton({Type:"Photo"===item.MediaType?"PhotoAlbum":"MusicAlbum",Id:item.AlbumId,Name:item.Album,ServerId:item.ServerId})):item.Album&&round.push('<div class="actionsheetPreviewTextItem mediaInfoItem">'+_textencoding.default.htmlEncode(item.Album)+"</div>"),item.ProductionYear&&"Episode"!==item.Type&&"Audio"!==item.Type&&round.push('<div class="actionsheetPreviewTextItem mediaInfoItem">'+item.ProductionYear+"</div>"),round.length&&lines.push(round.join(""));for(var i=0,length=Math.min(lines.length,3);i<length;i++)html=1<=i?(html+='<div class="actionsheetItemPreviewText mediaInfoItems secondaryText">')+lines[i]+"</div>":(html+='<div class="actionsheetItemPreviewText mediaInfoItems actionsheetItemPreviewText-main">')+lines[i]+"</div>";return html=html+"</div>"+"</div>"}(options,options.item)),forceAutoFocus+=previewHtml,options.title&&(previewHtml="actionSheetTitle",options.hideTitleWhenNotFullscreen&&!isFullscreen&&(previewHtml+=" actionSheetTitle-hideNonFullscreen"),forceAutoFocus=isFullscreen?(forceAutoFocus+='<h3 class="'+previewHtml+'">')+options.title+"</h3>":(forceAutoFocus+='<p class="'+previewHtml+' secondaryText actionSheetTitle-small">')+options.title+"</p>"),options.text&&(forceAutoFocus=(forceAutoFocus+='<p class="actionSheetText">')+options.text+"</p>"),"actionSheetScroller focuscontainer-x"),scrollSliderClass=" actionsheetScrollSlider scrollSlider flex flex-direction-column itemsContainer",dialogOptions=(isFullscreen?(previewHtml+=" actionSheetScroller-fullscreen",useVirtualScroller&&(previewHtml+=" actionSheetScroller-fullscreen-virtual")):(useVirtualScroller&&(previewHtml+=" flex-grow"),options.title&&!options.hideTitleWhenNotFullscreen&&(enablePaddingTop=!1)),dialogOptions&&(previewHtml+=" actionSheetScroller-focusscale",enablePaddingTop=enablePaddingBottom=!0),(options.title||options.text)&&(previewHtml+=" actionSheetScroller-withheader"),enablePaddingInline&&(previewHtml+=" actionSheetScroller-padding-inline"),enablePaddingTop&&(scrollSliderClass+=" actionSheetScroller-padding-top"),(enablePaddingBottom=isFullscreen||options.multiple&&!useVirtualScroller||!1!==options.highlight?enablePaddingBottom:!0)&&(scrollSliderClass+=" actionSheetScroller-padding-bottom"),options.multiple&&(scrollSliderClass+=" actionsheet-scrollSlider-multiple",_layoutmanager.default.tv)&&(scrollSliderClass+=" actionsheet-scrollSlider-multiple-tv"),""),btnCloseActionSheets=(useVirtualScroller&&(dialogOptions+=' data-virtualscrolllayout="vertical-grid"'),forceAutoFocus=(forceAutoFocus=forceAutoFocus+('<div is="emby-scroller" data-miniscrollbar="true" data-horizontal="false" data-focusscroll="true" class="'+previewHtml+'">')+('<div is="emby-itemscontainer" class="'+scrollSliderClass+' vertical-list"'+dialogOptions+">"))+"</div>"+"</div>",options.bottomText&&(forceAutoFocus=(forceAutoFocus+='<div class="actionSheetBottomText fieldDescription">')+options.bottomText+"</div>"),options.multiple&&useVirtualScroller&&(forceAutoFocus+='<div class="flex align-items-center justify-content-flex-start text-align-start" style="width:100%;"><div style="padding:1em .75em 1em .75em;" class="flex flex-grow align-items-center justify-content-center">',enablePaddingInline="btnActionSheetSelectNone",options.selectAllOnSelectNone?(selectNoneText=_globalize.default.translate("SelectAll"),enablePaddingInline+=" dlg-close"):selectNoneText=_globalize.default.translate("SelectNone"),forceAutoFocus=forceAutoFocus+'<button type="button" is="emby-button" class="button-link '+enablePaddingInline+'">'+selectNoneText+"</button></div></div>"),dlg.innerHTML=forceAutoFocus,dlg.querySelectorAll(".btnCloseActionSheet")),_i=0,_length=btnCloseActionSheets.length;_i<_length;_i++)btnCloseActionSheets[_i].addEventListener("click",onCancelClick);return new Promise(function(resolve,reject){var _dlg$querySelector,selectedItem,isResolved,hasSelectionChanged;function getResolveResult(){var _selectedItem;return options.multiple?hasSelectionChanged?options.selectedValuesClone:null:options.resolveWithSelectedItem?(null==(_selectedItem=selectedItem)?void 0:_selectedItem.originalItem)||selectedItem:null==(_selectedItem=selectedItem)?void 0:_selectedItem.Id}options.selectedValuesClone=(options.selectedValues||[]).slice(0);var itemsContainer=dlg.querySelector(".itemsContainer");function onValueChange(refreshItems){hasSelectionChanged=!0,options.onChange&&options.onChange(getResolveResult()),options.refreshItemsOnChange&&!1!==refreshItems&&(itemsContainer.scrollToIndex(0,{},itemsContainer.contains(document.activeElement)),itemsContainer.refreshItems())}itemsContainer.addEventListener("action-null",function(e){var _selectedItem5;options.multiple||(e=e.detail.item,selectedItem=e,e=options.resolveWithSelectedItem?(null==(e=selectedItem)?void 0:e.originalItem)||selectedItem:null==(e=selectedItem)?void 0:e.Id,!options.resolveOnClick||options.resolveOnClick.indexOf&&-1===options.resolveOnClick.indexOf(null==(_selectedItem5=selectedItem)?void 0:_selectedItem5.Id)||(resolve(e),isResolved=!0),_dialoghelper.default.close(dlg))}),itemsContainer.fetchData=getItemsFn(options),itemsContainer.getListOptions=getListOptions.bind(options),null!=(_dlg$querySelector=dlg.querySelector(".btnActionSheetSelectNone"))&&_dlg$querySelector.addEventListener("click",function(){options.selectedValuesClone=[],this.classList.contains("dlg-close")?(onValueChange(!1),_dialoghelper.default.close(dlg)):onValueChange()}),itemsContainer.addEventListener("change",function(e){hasSelectionChanged=!0;var arr,value,e=e.target.closest("input"),itemValue=_shortcuts.default.getItemFromChildNode(e,null,this).Id;arr=options.selectedValuesClone,value=itemValue,-1<(value=arr.indexOf(value))&&arr.splice(value,1),e.checked&&options.selectedValuesClone.push(itemValue),onValueChange()}),itemsContainer.addEventListener("itemdrop",function(e){e.preventDefault();var e=e.detail,item=e.items[0],item=options.selectedValuesClone.indexOf(item.Id);-1===item||e.newIndex>=options.selectedValuesClone.length||(options.selectedValuesClone=function(arr,old_index,new_index){if(new_index>=arr.length)throw new Error("out of bounds");return arr.splice(new_index,0,arr.splice(old_index,1)[0]),arr}(options.selectedValuesClone,item,e.newIndex),onValueChange())}),itemsContainer.afterRefresh=function(){itemsContainer.virtualScroller||callUpdateElement(itemsContainer,options)};var openingPromise=new Promise(function(resolve,reject){dlg.addEventListener("open",resolve)}),openedPromise=new Promise(function(resolve,reject){dlg.addEventListener("opened",resolve)}),closePromise=_dialoghelper.default.open(dlg);(useVirtualScroller?Promise.resolve():refreshItemsContainer.call(dlg)).then(function(){var timeout,refreshPromise;return dlg.dialogOptions.setDialogSize=!0,_dialoghelper.default.positionDialog(dlg),options.timeout&&(timeout=setTimeout(function(){_dialoghelper.default.close(dlg)},options.timeout)),useVirtualScroller&&(refreshPromise=refreshItemsContainer.call(dlg)),openingPromise.then(function(){_dialoghelper.default.positionDialog(dlg)}),openedPromise.then(function(){return(refreshPromise||Promise.resolve()).then(function(){var skipIfNotEnabled;this.classList.contains("dlg-autofocus")&&(skipIfNotEnabled=!this.classList.contains("dlg-autofocus-force"),autoFocusInternal(this,{skipIfNotEnabled:skipIfNotEnabled}))}.bind(dlg)),itemsContainer.virtualScroller&&itemsContainer.virtualScroller.onResized(),closePromise.then(function(){var resolveResult;if(instance.dlg=null,timeout&&(clearTimeout(timeout),timeout=null),!isResolved)return null!=(resolveResult=getResolveResult())?(options.callback&&options.callback(resolveResult),resolveResult):Promise.reject()})})}).then(resolve,reject)})},ActionSheet.prototype.refreshItems=function(){var _this$dlg=null==(_this$dlg=this.dlg)?void 0:_this$dlg.querySelector(".itemsContainer");_this$dlg&&_this$dlg.refreshItems()},ActionSheet.prototype.isShowing=function(){return null!=this.dlg},ActionSheet.prototype.autoFocus=function(options){console.log("focusing actionsheet"),autoFocusInternal(this.dlg,options)},ActionSheet.prototype.close=function(){var dlg=this.dlg;dlg&&_dialoghelper.default.close(dlg)},ActionSheet.prototype.destroy=function(){this.dlg=null};_exports.default={show:function(options){var actionSheet=new ActionSheet;return actionSheet.show(options).then(function(result){return actionSheet.destroy(),Promise.resolve(result)},function(result){return actionSheet.destroy(),Promise.reject(result)})},constructor:ActionSheet}});